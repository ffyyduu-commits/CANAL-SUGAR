<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>๐ ุงูููุงุฉ ููุณูุฑ 2050 - ูุธุงู ุญุฌุฒ ุงููุฌุจุงุช ุงููุณุชูุจูู</title>

    <!-- ๐จ ุงูุชุตููู ุงููุณุชูุจูู -->
    <link rel="stylesheet" href="style-2050.css">
    <link rel="manifest" href="manifest.json">

    <!-- ๐๏ธ ูุงุนุฏุฉ ุงูุจูุงูุงุช -->
    <script src="database/database.js"></script>
    <script src="database/api.js"></script>

    <!-- ๐ฏ Meta Tags ููุชุญุณูู -->
    <meta name="description" content="ูุธุงู ุญุฌุฒ ุงููุฌุจุงุช ุงููุณุชูุจูู ูุดุฑูุฉ ุงูููุงุฉ ููุณูุฑ - ุชุฌุฑุจุฉ ูุณุชุฎุฏู ูุชุทูุฑุฉ ูุณูุณุฉ">
    <meta name="keywords" content="ุญุฌุฒ ูุฌุจุงุช, ุงูููุงุฉ ููุณูุฑ, ูุธุงู ูุณุชูุจูู, ุชุทุจูู ููุจ">
    <meta name="author" content="ุงูููุงุฉ ููุณูุฑ">
    <meta name="theme-color" content="#0a0e27">

    <!-- ๐ Preload ููุฎุทูุท -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
</head>
<body>
    <!-- ๐ ุงูููุฏุฑ ุงููุณุชูุจูู -->
    <header>
        <div class="header-content">
            <div class="logo-section">
                <div class="logo">๐ญ</div>
                <div class="logo-text">
                    <h1 class="logo-title" data-translate="company_name">ุงูููุงุฉ ููุณูุฑ</h1>
                    <p class="logo-subtitle">ูุธุงู ุญุฌุฒ ุงููุฌุจุงุช ุงููุณุชูุจูู</p>
                </div>
            </div>

            <!-- ๐ ูุจุฏู ุงููุบุฉ ุงููุณุชูุจูู -->
            <div class="language-switcher">
                <button class="lang-btn active" data-lang="ar">
                    <span>๐ธ๐ฆ</span>
                    <span>ุนุฑุจู</span>
                </button>
                <button class="lang-btn" data-lang="en">
                    <span>๐บ๐ธ</span>
                    <span>English</span>
                </button>
            </div>
        </div>
    </header>
    <main>
        <!-- ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู -->
        <section id="login-section" class="login-section-page">
            <div class="login-container">
                <div class="login-logo-section">
                    <div class="login-logo">
                        <img src="canal-sugar-logo.png" alt="ุดุนุงุฑ ุงูููุงุฉ ููุณูุฑ" class="login-page-logo" onerror="this.style.display='none'; document.querySelector('.text-logo').style.display='block';">
                        <div class="text-logo" style="display: none;">
                            <div class="logo-circle">CS</div>
                        </div>
                    </div>
                    <div class="company-name-login">
                        <h2>ุงูููุงุฉ ููุณูุฑ</h2>
                        <p class="company-name-en-login">CANAL SUGAR</p>
                    </div>
                </div>
                <div class="login-header">
                    <h3 data-translate="welcome_message">ูุฑุญุจุงู ุจู ูู ูุธุงู ุญุฌุฒ ุงููุฌุจุงุช</h3>
                    <p class="login-subtitle" data-translate="login_subtitle">ูุฑุฌู ุชุณุฌูู ุงูุฏุฎูู ูููุชุงุจุนุฉ</p>
                </div>

                <form id="main-login-form" class="login-form" onsubmit="handleMainLogin(event)">
                    <div class="form-group">
                        <label for="main-username" data-translate="username_label">ุงุณู ุงููุณุชุฎุฏู ุฃู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:</label>
                        <input type="text" id="main-username" name="username" required data-translate-placeholder="username_placeholder">
                    </div>
                    <div class="form-group">
                        <label for="main-password" data-translate="password_label">ูููุฉ ุงููุฑูุฑ:</label>
                        <input type="password" id="main-password" name="password" required data-translate-placeholder="password_placeholder">
                    </div>
                    <button type="submit" class="main-login-btn" data-translate="login_button">ุฏุฎูู</button>
                    <div class="form-links">
                        <a href="#" onclick="showForgotPassword()" data-translate="forgot_password">ูุณูุช ูููุฉ ุงููุฑูุฑุ</a>
                        <span> | </span>
                        <a href="#" onclick="showRegisterForm()" data-translate="create_account">ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ</a>
                    </div>
                    <div class="quick-access">
                        <button type="button" class="quick-btn" onclick="createAdminQuick()">ุฅูุดุงุก ุญุณุงุจ ุงููุดุฑู ุงูุณุฑูุน</button>
                        <small>ููุงุฎุชุจุงุฑ: admin / canal2025</small>
                    </div>
                </form>

                <!-- ูููุฐุฌ ุงูุชุณุฌูู -->
                <form id="register-form" class="login-form hidden" onsubmit="handleRegister(event)">
                    <h3>ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ</h3>
                    <div class="form-group">
                        <label for="reg-username">ุงุณู ุงููุณุชุฎุฏู:</label>
                        <input type="text" id="reg-username" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-email">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:</label>
                        <input type="email" id="reg-email" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-fullname">ุงูุงุณู ุงููุงูู:</label>
                        <input type="text" id="reg-fullname" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-password">ูููุฉ ุงููุฑูุฑ:</label>
                        <input type="password" id="reg-password" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-employee-id">ุฑูู ุงูููุธู (ุงุฎุชูุงุฑู):</label>
                        <input type="text" id="reg-employee-id">
                    </div>
                    <button type="submit" class="main-login-btn">ุฅูุดุงุก ุงูุญุณุงุจ</button>
                    <div class="form-links">
                        <a href="#" onclick="showLoginForm()">ุงูุนูุฏุฉ ูุชุณุฌูู ุงูุฏุฎูู</a>
                    </div>
                </form>
            </div>
        </section>

        <!-- ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ (ุชุธูุฑ ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู) -->
        <section id="home-section" class="home-section hidden">
            <div class="welcome-container">
                <div class="user-welcome">
                    <h2 id="welcome-message">ูุฑุญุจุงู ุจู ูู ูุธุงู ุญุฌุฒ ุงููุฌุจุงุช</h2>
                    <div class="user-actions">
                        <span id="user-name-display"></span>
                        <button class="admin-access-btn" onclick="showSection('admin-section')" title="ููุญุฉ ุชุญูู ุงููุดุฑู">๐ง</button>
                        <button class="logout-btn-header" onclick="logout()">ุชุณุฌูู ุงูุฎุฑูุฌ</button>
                    </div>
                </div>

                <div class="main-menu">
                    <div class="menu-card" onclick="showSection('meal-section')">
                        <div class="menu-icon">๐ฝ๏ธ</div>
                        <h3 data-translate="book_meals">ุญุฌุฒ ุงููุฌุจุงุช</h3>
                        <p data-translate="book_meals_desc">ุงุญุฌุฒ ูุฌุจุชู ุงูููููุฉ</p>
                    </div>

                    <div class="menu-card" onclick="showSection('reservations-section')">
                        <div class="menu-icon">๐</div>
                        <h3 data-translate="my_reservations">ุญุฌูุฒุงุชู</h3>
                        <p data-translate="my_reservations_desc">ุนุฑุถ ูุฅุฏุงุฑุฉ ุญุฌูุฒุงุชู</p>
                    </div>

                    <div class="menu-card" onclick="showSection('profile-section')">
                        <div class="menu-icon">๐ค</div>
                        <h3 data-translate="profile">ุงูููู ุงูุดุฎุตู</h3>
                        <p data-translate="profile_desc">ุฅุฏุงุฑุฉ ุจูุงูุงุชู ุงูุดุฎุตูุฉ</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ุตูุญุฉ ุญุฌุฒ ุงููุฌุจุงุช -->
        <section id="meal-section" class="meal-section hidden">
            <div class="section-header">
                <button class="back-btn" onclick="showSection('home-section')" data-translate="back_to_home">โ ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ</button>
                <h2 data-translate="select_meal_type">ุงุฎุชุฑ ููุน ุงููุฌุจุฉ</h2>
            </div>

            <!-- ูุคุดุฑ ุงูููุช ุงูุญุงูู ูุงููุฌุจุฉ ุงููุดุทุฉ -->
            <div class="time-indicator">
                <div class="current-time">
                    <span data-translate="current_time">ุงูููุช ุงูุญุงูู:</span>
                    <span id="current-time-display">00:00</span>
                </div>
                <div class="active-meal-status" id="active-meal-status">
                    <span class="status-text" id="meal-status-text">ูุง ุชูุฌุฏ ูุฌุจุฉ ูุชุงุญุฉ ุญุงููุงู</span>
                </div>
            </div>

            <!-- ูุคูุช ุงููุฌุจุฉ -->
            <div class="meal-timer" id="meal-timer" style="display: none;">
                <div class="timer-header">
                    <span id="timer-title">ููุช ูุชุจูู ูููุฌุจุฉ</span>
                </div>
                <div class="timer-display">
                    <div class="timer-unit">
                        <span id="hours">00</span>
                        <label data-translate="hours">ุณุงุนุฉ</label>
                    </div>
                    <div class="timer-separator">:</div>
                    <div class="timer-unit">
                        <span id="minutes">00</span>
                        <label data-translate="minutes">ุฏูููุฉ</label>
                    </div>
                    <div class="timer-separator">:</div>
                    <div class="timer-unit">
                        <span id="seconds">00</span>
                        <label data-translate="seconds">ุซุงููุฉ</label>
                    </div>
                </div>
            </div>

            <select id="meal-type" onchange="handleMealChange()">
                <option value="breakfast" data-translate="breakfast">ูุทูุฑ ุตุจุงุญู</option>
                <option value="lunch" data-translate="lunch">ุบุฏุงุก</option>
                <option value="dinner" data-translate="dinner">ุนุดุงุก</option>
                <option value="suhour" data-translate="suhour">ุณุญูุฑ</option>
            </select>

            <div class="meal-details">
                <img src="images/breakfast.svg" alt="Meal Image" id="meal-img">
                <h3 id="meal-name">ุงุณู ุงููุฌุจุฉ</h3>
                <p id="meal-desc">ูุตู ุงููุฌุจุฉ ูุธูุฑ ููุง...</p>
                <div class="meal-time-info" id="meal-time-info">
                    <span class="time-label" data-translate="available_time">ูุชุงุญ ูู:</span>
                    <span id="meal-time-range">00:00 - 00:00</span>
                </div>
                <div id="meal-options" class="meal-options">
                  <!-- ุฎูุงุฑุงุช ุงููุฌุจุฉ ุชุธูุฑ ููุง -->
                </div>
            </div>
            <button class="reserve-btn" id="reserve-btn" data-translate="book_now" onclick="handleReservation()">ุงุญุฌุฒ ุงูุขู</button>

            <!-- ุฃุฒุฑุงุฑ ุงูุชุญูู ูุงูุงุฎุชุจุงุฑ -->
            <div class="test-controls" style="margin-top: 20px; text-align: center; padding: 15px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                <h4 style="margin: 0 0 10px 0; color: #495057; font-size: 14px;">๐๏ธ ุฃุฏูุงุช ุงูุชุญูู ูุงูุงุฎุชุจุงุฑ</h4>
                <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 8px;">
                    <button onclick="forceRefreshMealsSection()" style="background: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 13px;">๐ ุฅุนุงุฏุฉ ุชุญููู ูุงููุฉ</button>
                    <button onclick="initializeMealsSection()" style="background: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 13px;">๐ง ุฅุนุงุฏุฉ ุชููุฆุฉ</button>
                    <button onclick="testTimer()" style="background: #6f42c1; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 13px;">๐งช ุงุฎุชุจุงุฑ ุงููุคูุช</button>
                    <button onclick="forceShowTimer()" style="background: #fd7e14; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 13px;">โฐ ุฅุธูุงุฑ ุงููุคูุช</button>
                    <button onclick="debugMealsSection()" style="background: #dc3545; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 13px;">๐ ุชุดุฎูุต ุงููุดุงูู</button>
                </div>
            </div>
        </section>

        <!-- ุตูุญุฉ ุงูุญุฌูุฒุงุช -->
        <section id="reservations-section" class="reservations-section hidden">
            <div class="section-header">
                <button class="back-btn" onclick="showSection('home-section')">โ ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ</button>
                <h2>ุญุฌูุฒุงุชู</h2>
                <button class="refresh-btn" onclick="loadUserReservations()">๐ ุชุญุฏูุซ</button>
            </div>
            <div class="reservations-list" id="reservations-list">
                <p class="no-reservations">ุฌุงุฑู ุชุญููู ุงูุญุฌูุฒุงุช...</p>
            </div>
        </section>

        <!-- ุตูุญุฉ ุงูููู ุงูุดุฎุตู -->
        <section id="profile-section" class="profile-section hidden">
            <div class="section-header">
                <button class="back-btn" onclick="showSection('home-section')">โ ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ</button>
                <h2>ุงูููู ุงูุดุฎุตู</h2>
            </div>
            <div class="profile-info">
                <p>ูุนูููุงุช ุงููุณุชุฎุฏู ุณุชุธูุฑ ููุง ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู</p>
            </div>
        </section>

        <!-- ุตูุญุฉ ุงููุดุฑู -->
        <section id="admin-section" class="admin-section hidden">
            <div class="section-header">
                <button class="back-btn" onclick="showSection('home-section')">โ ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ</button>
                <h2>๐ง ููุญุฉ ุชุญูู ุงููุดุฑู</h2>
            </div>

            <!-- ุชุณุฌูู ุฏุฎูู ุงููุดุฑู -->
            <div id="admin-login-container" class="admin-login-container">
                <div class="admin-login-card">
                    <h3>๐ ุชุณุฌูู ุฏุฎูู ุงููุดุฑู</h3>
                    <form id="admin-login-form" onsubmit="handleAdminLogin(event)">
                        <div class="form-group">
                            <label for="admin-username">ุงุณู ุงููุณุชุฎุฏู:</label>
                            <input type="text" id="admin-username" required>
                        </div>
                        <div class="form-group">
                            <label for="admin-password">ูููุฉ ุงููุฑูุฑ:</label>
                            <input type="password" id="admin-password" required>
                        </div>
                        <button type="submit" class="admin-login-btn">ุฏุฎูู ุงููุดุฑู</button>
                    </form>
                </div>
            </div>

            <!-- ููุญุฉ ุชุญูู ุงููุดุฑู -->
            <div id="admin-dashboard" class="admin-dashboard hidden">
                <div class="admin-welcome">
                    <h3>ูุฑุญุจุงู ุจู ูู ููุญุฉ ุงูุชุญูู</h3>
                    <button class="admin-logout-btn" onclick="logoutAdmin()">ุชุณุฌูู ุฎุฑูุฌ ุงููุดุฑู</button>
                </div>

                <div class="admin-cards-grid">
                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h4>๐ ุฅุญุตุงุฆูุงุช ุงูุญุฌูุฒุงุช</h4>
                        </div>
                        <div class="admin-card-content">
                            <table class="reservations-table">
                                <thead>
                                    <tr>
                                        <th>ุงููุฌุจุฉ</th>
                                        <th>ุนุฏุฏ ุงูุญุฌูุฒุงุช</th>
                                        <th>ุงูุญุงูุฉ</th>
                                    </tr>
                                </thead>
                                <tbody id="meals-status-table">
                                    <tr>
                                        <td>ูุทูุฑ ุตุจุงุญู</td>
                                        <td><span class="count-badge">0</span></td>
                                        <td><span class="status-active" id="breakfast-status">ูุดุท</span></td>
                                    </tr>
                                    <tr>
                                        <td>ุบุฏุงุก</td>
                                        <td><span class="count-badge">0</span></td>
                                        <td><span class="status-active" id="lunch-status">ูุดุท</span></td>
                                    </tr>
                                    <tr>
                                        <td>ุนุดุงุก</td>
                                        <td><span class="count-badge">0</span></td>
                                        <td><span class="status-active" id="dinner-status">ูุดุท</span></td>
                                    </tr>
                                    <tr>
                                        <td>ุณุญูุฑ</td>
                                        <td><span class="count-badge">0</span></td>
                                        <td><span class="status-active" id="suhour-status">ูุดุท</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h4>๐ผ๏ธ ุฅุฏุงุฑุฉ ุงููุฌุจุงุช</h4>
                        </div>
                        <div class="admin-card-content">
                            <div class="meals-management-grid">
                                <div class="meal-management-item">
                                    <img src="images/breakfast.svg" alt="ูุทูุฑ ุตุจุงุญู" class="admin-meal-img" id="admin-breakfast-img">
                                    <h5>ูุทูุฑ ุตุจุงุญู</h5>
                                    <p class="meal-time">6:00 - 9:00</p>
                                    <div class="admin-meal-actions">
                                        <button class="edit-meal-btn" onclick="editMeal('breakfast')">โ๏ธ ุชุญุฑูุฑ</button>
                                        <button class="change-image-btn" onclick="changeMealImage('breakfast')">๐ผ๏ธ ุชุบููุฑ ุงูุตูุฑุฉ</button>
                                    </div>
                                </div>
                                <div class="meal-management-item">
                                    <img src="images/lunch.svg" alt="ุบุฏุงุก" class="admin-meal-img" id="admin-lunch-img">
                                    <h5>ุบุฏุงุก</h5>
                                    <p class="meal-time">12:00 - 13:00</p>
                                    <div class="admin-meal-actions">
                                        <button class="edit-meal-btn" onclick="editMeal('lunch')">โ๏ธ ุชุญุฑูุฑ</button>
                                        <button class="change-image-btn" onclick="changeMealImage('lunch')">๐ผ๏ธ ุชุบููุฑ ุงูุตูุฑุฉ</button>
                                    </div>
                                </div>
                                <div class="meal-management-item">
                                    <img src="images/dinner.svg" alt="ุนุดุงุก" class="admin-meal-img" id="admin-dinner-img">
                                    <h5>ุนุดุงุก</h5>
                                    <p class="meal-time">18:00 - 20:00</p>
                                    <div class="admin-meal-actions">
                                        <button class="edit-meal-btn" onclick="editMeal('dinner')">โ๏ธ ุชุญุฑูุฑ</button>
                                        <button class="change-image-btn" onclick="changeMealImage('dinner')">๐ผ๏ธ ุชุบููุฑ ุงูุตูุฑุฉ</button>
                                    </div>
                                </div>
                                <div class="meal-management-item">
                                    <img src="images/suhour.svg" alt="ุณุญูุฑ" class="admin-meal-img" id="admin-suhour-img">
                                    <h5>ุณุญูุฑ</h5>
                                    <p class="meal-time">3:00 - 5:00</p>
                                    <div class="admin-meal-actions">
                                        <button class="edit-meal-btn" onclick="editMeal('suhour')">โ๏ธ ุชุญุฑูุฑ</button>
                                        <button class="change-image-btn" onclick="changeMealImage('suhour')">๐ผ๏ธ ุชุบููุฑ ุงูุตูุฑุฉ</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h4>โ๏ธ ุฅุนุฏุงุฏุงุช ุงููุธุงู</h4>
                        </div>
                        <div class="admin-card-content">
                            <div class="admin-controls">
                                <div class="control-group">
                                    <label>ุชูุนูู/ุชุนุทูู ุงููุฌุจุงุช:</label>
                                    <select id="meal-toggle-select" onchange="updateMealToggleUI()">
                                        <option value="breakfast">ูุทูุฑ ุตุจุงุญู</option>
                                        <option value="lunch">ุบุฏุงุก</option>
                                        <option value="dinner">ุนุดุงุก</option>
                                        <option value="suhour">ุณุญูุฑ</option>
                                    </select>
                                    <button class="toggle-meal-btn" onclick="toggleMeal()">ุชุจุฏูู ุงูุญุงูุฉ</button>
                                </div>
                                <div class="control-group">
                                    <button class="export-btn" onclick="exportData()">๐ฅ ุชุตุฏูุฑ ุงูุจูุงูุงุช</button>
                                    <button class="reset-btn" onclick="resetMealsData()">๐ ุฅุนุงุฏุฉ ุชุนููู ุงููุฌุจุงุช</button>
                                    <button class="reset-btn" onclick="resetSystem()">๐๏ธ ุฅุนุงุฏุฉ ุชุนููู ุงููุธุงู</button>
                                </div>
                                <div class="control-group">
                                    <label>ุงุฎุชุจุงุฑ ุงููุธุงู:</label>
                                    <button class="test-btn" onclick="enableTestMode()">๐งช ุชูุนูู ูุถุน ุงูุงุฎุชุจุงุฑ</button>
                                    <button class="test-btn" onclick="disableTestMode()">โน๏ธ ุฅููุงู ูุถุน ุงูุงุฎุชุจุงุฑ</button>
                                    <button class="test-btn" onclick="setTestTime('breakfast')">๐ ุงุฎุชุจุงุฑ ุงููุทูุฑ</button>
                                    <button class="test-btn" onclick="setTestTime('lunch')">๐ฝ๏ธ ุงุฎุชุจุงุฑ ุงูุบุฏุงุก</button>
                                    <button class="test-btn" onclick="setTestTime('dinner')">๐ ุงุฎุชุจุงุฑ ุงูุนุดุงุก</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>



    <!-- ูุงูุฐุฉ ุชุญุฑูุฑ ุงููุฌุจุฉ -->
    <div id="edit-meal-modal" class="modal hidden">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3 id="edit-meal-title">ุชุญุฑูุฑ ุงููุฌุจุฉ</h3>
                <button class="close-btn" onclick="closeEditMealModal()">&times;</button>
            </div>
            <form id="edit-meal-form" onsubmit="saveMealChanges(event)">
                <div class="modal-body">
                    <div class="form-row">
                        <div class="form-group">
                            <label>ุงูุงุณู ุจุงูุนุฑุจูุฉ:</label>
                            <input type="text" id="meal-name-ar" required>
                        </div>
                        <div class="form-group">
                            <label>ุงูุงุณู ุจุงูุฅูุฌููุฒูุฉ:</label>
                            <input type="text" id="meal-name-en" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ุงููุตู ุจุงูุนุฑุจูุฉ:</label>
                        <textarea id="meal-desc-ar" rows="3" required></textarea>
                    </div>

                    <div class="form-group">
                        <label>ุงููุตู ุจุงูุฅูุฌููุฒูุฉ:</label>
                        <textarea id="meal-desc-en" rows="3" required></textarea>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>ููุช ุงูุจุฏุงูุฉ:</label>
                            <input type="time" id="meal-start-time" required>
                        </div>
                        <div class="form-group">
                            <label>ููุช ุงูููุงูุฉ:</label>
                            <input type="time" id="meal-end-time" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ุฎูุงุฑุงุช ุงููุฌุจุฉ (ุงูุนุฑุจูุฉ) - ููุตููุฉ ุจูุงุตูุฉ:</label>
                        <input type="text" id="meal-options-ar" placeholder="ุณุงุฎู, ุจุฏูู, ุตุญู">
                    </div>

                    <div class="form-group">
                        <label>ุฎูุงุฑุงุช ุงููุฌุจุฉ (ุงูุฅูุฌููุฒูุฉ) - ููุตููุฉ ุจูุงุตูุฉ:</label>
                        <input type="text" id="meal-options-en" placeholder="Hot, Alternative, Healthy">
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="cancel-btn" onclick="closeEditMealModal()">ุฅูุบุงุก</button>
                    <button type="submit" class="save-btn">ุญูุธ ุงูุชุบููุฑุงุช</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ูุงูุฐุฉ ุชุบููุฑ ุงูุตูุฑุฉ -->
    <div id="change-image-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="change-image-title">ุชุบููุฑ ุตูุฑุฉ ุงููุฌุจุฉ</h3>
                <button class="close-btn" onclick="closeChangeImageModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="image-upload-area">
                    <input type="file" id="meal-image-input" accept="image/*" onchange="previewImage(event)">
                    <div class="upload-placeholder" onclick="document.getElementById('meal-image-input').click()">
                        <div class="upload-icon">๐</div>
                        <p>ุงููุฑ ูุงุฎุชูุงุฑ ุตูุฑุฉ ุฌุฏูุฏุฉ</p>
                        <small>PNG, JPG, SVG (ุฃูู ูู 2MB)</small>
                    </div>
                    <div class="image-preview" id="image-preview" style="display: none;">
                        <img id="preview-img" src="" alt="ูุนุงููุฉ">
                        <button type="button" class="remove-preview" onclick="removePreview()">ร</button>
                    </div>
                </div>

                <div class="predefined-images">
                    <h4>ุฃู ุงุฎุชุฑ ูู ุงูุตูุฑ ุงููุชุงุญุฉ:</h4>
                    <div class="predefined-grid">
                        <div class="predefined-item" onclick="selectPredefinedImage('images/breakfast.svg')">
                            <img src="images/breakfast.svg" alt="ูุทูุฑ">
                            <span>ูุทูุฑ</span>
                        </div>
                        <div class="predefined-item" onclick="selectPredefinedImage('images/lunch.svg')">
                            <img src="images/lunch.svg" alt="ุบุฏุงุก">
                            <span>ุบุฏุงุก</span>
                        </div>
                        <div class="predefined-item" onclick="selectPredefinedImage('images/dinner.svg')">
                            <img src="images/dinner.svg" alt="ุนุดุงุก">
                            <span>ุนุดุงุก</span>
                        </div>
                        <div class="predefined-item" onclick="selectPredefinedImage('images/suhour.svg')">
                            <img src="images/suhour.svg" alt="ุณุญูุฑ">
                            <span>ุณุญูุฑ</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="cancel-btn" onclick="closeChangeImageModal()">ุฅูุบุงุก</button>
                <button type="button" class="save-btn" onclick="saveImageChanges()">ุญูุธ ุงูุตูุฑุฉ</button>
            </div>
        </div>
    </div>

    <footer>
        <p data-translate="copyright">ุฌููุน ุงูุญููู ูุญููุธุฉ &copy; ุงูููุงุฉ ููุณูุฑ 2025</p>
    </footer>
    <script>
    // ูุธุงู ุงูุชุฑุฌูุฉ
    let currentLanguage = 'ar';

    const translations = {
      ar: {
        company_name: 'ุงูููุงุฉ ููุณูุฑ',
        welcome_message: 'ูุฑุญุจุงู ุจู ูู ูุธุงู ุญุฌุฒ ุงููุฌุจุงุช',
        login_subtitle: 'ูุฑุฌู ุชุณุฌูู ุงูุฏุฎูู ูููุชุงุจุนุฉ',
        username_label: 'ุงุณู ุงููุณุชุฎุฏู ุฃู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:',
        password_label: 'ูููุฉ ุงููุฑูุฑ:',
        username_placeholder: 'ุฃุฏุฎู ุงุณู ุงููุณุชุฎุฏู',
        password_placeholder: 'ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ',
        login_button: 'ุฏุฎูู',
        forgot_password: 'ูุณูุช ูููุฉ ุงููุฑูุฑุ',
        book_meals: 'ุญุฌุฒ ุงููุฌุจุงุช',
        book_meals_desc: 'ุงุญุฌุฒ ูุฌุจุชู ุงูููููุฉ',
        my_reservations: 'ุญุฌูุฒุงุชู',
        my_reservations_desc: 'ุนุฑุถ ูุฅุฏุงุฑุฉ ุญุฌูุฒุงุชู',
        profile: 'ุงูููู ุงูุดุฎุตู',
        profile_desc: 'ุฅุฏุงุฑุฉ ุจูุงูุงุชู ุงูุดุฎุตูุฉ',
        logout: 'ุชุณุฌูู ุงูุฎุฑูุฌ',
        back_to_home: 'ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ',
        select_meal_type: 'ุงุฎุชุฑ ููุน ุงููุฌุจุฉ',
        breakfast: 'ูุทูุฑ ุตุจุงุญู',
        lunch: 'ุบุฏุงุก',
        dinner: 'ุนุดุงุก',
        suhour: 'ุณุญูุฑ',
        book_now: 'ุงุญุฌุฒ ุงูุขู',
        admin_panel: 'ููุญุฉ ุชุญูู ุงููุดุฑู',
        admin_login: 'ุชุณุฌูู ุฏุฎูู ุงููุดุฑู',
        admin_dashboard: 'ููุญุฉ ุงูุชุญูู',
        reservations_stats: 'ุฅุญุตุงุฆูุงุช ุงูุญุฌูุฒุงุช',
        manage_images: 'ุฅุฏุงุฑุฉ ุตูุฑ ุงููุฌุจุงุช',
        system_settings: 'ุฅุนุฏุงุฏุงุช ุงููุธุงู',
        copyright: 'ุฌููุน ุงูุญููู ูุญููุธุฉ ยฉ ุงูููุงุฉ ููุณูุฑ 2025',
        current_time: 'ุงูููุช ุงูุญุงูู:',
        available_time: 'ูุชุงุญ ูู:',
        hours: 'ุณุงุนุฉ',
        minutes: 'ุฏูููุฉ',
        seconds: 'ุซุงููุฉ',
        time_remaining: 'ููุช ูุชุจูู ูููุฌุจุฉ',
        time_until_start: 'ููุช ูุชุจูู ูุจุฏุงูุฉ ุงููุฌุจุฉ',
        meal_available: 'ุงููุฌุจุฉ ูุชุงุญุฉ ุงูุขู',
        meal_ended: 'ุงูุชูุช ูุชุฑุฉ ุงููุฌุจุฉ',
        meal_not_available: 'ูุง ุชูุฌุฏ ูุฌุจุฉ ูุชุงุญุฉ ุญุงููุงู',
        booking_disabled: 'ุงูุญุฌุฒ ุบูุฑ ูุชุงุญ ุฎุงุฑุฌ ุฃููุงุช ุงููุฌุจุฉ',
        create_account: 'ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ',
        time_remaining: 'ุงูููุช ุงููุชุจูู',
        time_until_start: 'ุงูููุช ุญุชู ุงููุฌุจุฉ ุงูุชุงููุฉ'
      },
      en: {
        company_name: 'Canal Sugar',
        welcome_message: 'Welcome to Meal Booking System',
        login_subtitle: 'Please login to continue',
        username_label: 'Username or Email:',
        password_label: 'Password:',
        username_placeholder: 'Enter username',
        password_placeholder: 'Enter password',
        login_button: 'Login',
        forgot_password: 'Forgot Password?',
        book_meals: 'Book Meals',
        book_meals_desc: 'Book your daily meal',
        my_reservations: 'My Reservations',
        my_reservations_desc: 'View and manage your bookings',
        profile: 'Profile',
        profile_desc: 'Manage your personal information',
        logout: 'Logout',
        back_to_home: 'Back to Home',
        select_meal_type: 'Select Meal Type',
        breakfast: 'Breakfast',
        lunch: 'Lunch',
        dinner: 'Dinner',
        suhour: 'Suhour',
        book_now: 'Book Now',
        admin_panel: 'Admin Panel',
        admin_login: 'Admin Login',
        admin_dashboard: 'Dashboard',
        reservations_stats: 'Reservations Statistics',
        manage_images: 'Manage Meal Images',
        system_settings: 'System Settings',
        copyright: 'All Rights Reserved ยฉ Canal Sugar 2025',
        current_time: 'Current Time:',
        available_time: 'Available from:',
        hours: 'Hours',
        minutes: 'Minutes',
        seconds: 'Seconds',
        time_remaining: 'Time remaining for meal',
        time_until_start: 'Time until meal starts',
        meal_available: 'Meal is available now',
        meal_ended: 'Meal time has ended',
        meal_not_available: 'No meal available currently',
        booking_disabled: 'Booking not available outside meal times',
        create_account: 'Create New Account',
        time_remaining: 'Time Remaining',
        time_until_start: 'Time Until Next Meal'
      }
    };

    function switchLanguage(lang) {
      currentLanguage = lang;

      // ุชุญุฏูุซ ุงุชุฌุงู ุงูุตูุญุฉ
      document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
      document.documentElement.lang = lang;

      // ุชุญุฏูุซ ุฃุฒุฑุงุฑ ุงููุบุฉ
      document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.getAttribute('data-lang') === lang) {
          btn.classList.add('active');
        }
      });

      // ุชุญุฏูุซ ุงููุตูุต
      updateTexts();

      // ุญูุธ ุงููุบุฉ ุงููุฎุชุงุฑุฉ
      localStorage.setItem('selectedLanguage', lang);
    }

    function updateTexts() {
      const texts = translations[currentLanguage];

      // ุชุญุฏูุซ ุงููุตูุต ุงูุนุงุฏูุฉ
      document.querySelectorAll('[data-translate]').forEach(element => {
        const key = element.getAttribute('data-translate');
        if (texts[key]) {
          element.textContent = texts[key];
        }
      });

      // ุชุญุฏูุซ placeholders
      document.querySelectorAll('[data-translate-placeholder]').forEach(element => {
        const key = element.getAttribute('data-translate-placeholder');
        if (texts[key]) {
          element.placeholder = texts[key];
        }
      });

      // ุชุญุฏูุซ ุฎูุงุฑุงุช ุงููุฌุจุงุช
      updateMealOptions();

      // ุชุญุฏูุซ ุชูุงุตูู ุงููุฌุจุฉ ุงูุญุงููุฉ
      if (mealType && mealType.value) {
        updateMealDetails(mealType.value);
      }
    }

    function updateMealOptions() {
      const mealSelect = document.getElementById('meal-type');
      if (mealSelect) {
        const texts = translations[currentLanguage];
        mealSelect.innerHTML = `
          <option value="breakfast">${texts.breakfast}</option>
          <option value="lunch">${texts.lunch}</option>
          <option value="dinner">${texts.dinner}</option>
          <option value="suhour">${texts.suhour}</option>
        `;
      }
    }

    // ุชุญููู ุงููุบุฉ ุงููุญููุธุฉ ุนูุฏ ุจุฏุก ุงูุชุทุจูู
    function loadSavedLanguage() {
      const savedLang = localStorage.getItem('selectedLanguage') || 'ar';
      switchLanguage(savedLang);
    }

    // ูุชุบูุฑ ูุญุงูุฉ ุชุณุฌูู ุงูุฏุฎูู
    let isLoggedIn = false;
    let currentUser = null;

    // ูุธุงุฆู ุงูุชููู ุจูู ุงูุตูุญุงุช
    function showSection(sectionId) {
      // ุงูุชุญูู ูู ุชุณุฌูู ุงูุฏุฎูู ูุจู ุงููุตูู ููุตูุญุงุช ุงููุญููุฉ
      if (!isLoggedIn && sectionId !== 'login-section') {
        alert('ูุฑุฌู ุชุณุฌูู ุงูุฏุฎูู ุฃููุงู');
        return;
      }

      // ุฅุฎูุงุก ุฌููุน ุงูุฃูุณุงู
      const sections = document.querySelectorAll('main section');
      sections.forEach(section => {
        section.classList.add('hidden');
      });

      // ุฅุธูุงุฑ ุงููุณู ุงููุทููุจ
      document.getElementById(sectionId).classList.remove('hidden');
    }

    // ุชุณุฌูู ุงูุฏุฎูู ุงูุฑุฆูุณู
    async function handleMainLogin(event) {
      event.preventDefault();

      const username = document.getElementById('main-username').value;
      const password = document.getElementById('main-password').value;

      if (!username || !password) {
        alert('ูุฑุฌู ุฅุฏุฎุงู ุงุณู ุงููุณุชุฎุฏู ููููุฉ ุงููุฑูุฑ');
        return;
      }

      try {
        // ุชุณุฌูู ุงูุฏุฎูู ุจุงุณุชุฎุฏุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช
        const result = await canalAPI.login(username, password);

        if (result.success) {
          // ุชุญุฏูุซ ุญุงูุฉ ุชุณุฌูู ุงูุฏุฎูู
          isLoggedIn = true;
          currentUser = result.user.username;

          // ุฅุธูุงุฑ ุฑุณุงูุฉ ูุฌุงุญ
          alert(`ูุฑุญุจุงู ${result.user.full_name}! ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ`);

          // ุชุญุฏูุซ ูุงุฌูุฉ ุงููุณุชุฎุฏู
          updateUIAfterLogin(result.user.full_name);

          // ุงูุงูุชูุงู ููุตูุญุฉ ุงูุฑุฆูุณูุฉ
          showSection('home-section');
        } else {
          alert(result.error || 'ูุดู ูู ุชุณุฌูู ุงูุฏุฎูู');
        }
      } catch (error) {
        console.error('Login error:', error);
        alert('ุญุฏุซ ุฎุทุฃ ูู ุชุณุฌูู ุงูุฏุฎูู');
      }
    }

    function updateUIAfterLogin(username) {
      // ุชุญุฏูุซ ุฑุณุงูุฉ ุงูุชุฑุญูุจ
      document.getElementById('welcome-message').textContent = `ูุฑุญุจุงู ${username}`;
      document.getElementById('user-name-display').textContent = `ูุฑุญุจุงูุ ${username}`;

      // ุชุญุฏูุซ ุตูุญุฉ ุงูููู ุงูุดุฎุตู
      const profileInfo = document.querySelector('.profile-info');
      profileInfo.innerHTML = `
        <div class="user-info">
          <h3>ูุฑุญุจุงูุ ${username}</h3>
          <p>ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ</p>
          <p><strong>ุงุณู ุงููุณุชุฎุฏู:</strong> ${username}</p>
          <p><strong>ุญุงูุฉ ุงูุญุณุงุจ:</strong> ูุดุท</p>
          <button class="logout-btn" onclick="logout()">ุชุณุฌูู ุงูุฎุฑูุฌ</button>
        </div>
      `;
    }

    async function logout() {
      if (confirm('ูู ุชุฑูุฏ ุชุณุฌูู ุงูุฎุฑูุฌุ')) {
        try {
          // ุชุณุฌูู ุงูุฎุฑูุฌ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
          await canalAPI.logout();

          // ุฅุนุงุฏุฉ ุชุนููู ุญุงูุฉ ุชุณุฌูู ุงูุฏุฎูู
          isLoggedIn = false;
          currentUser = null;

          // ูุณุญ ุงูููุงุฐุฌ
          document.getElementById('main-login-form').reset();

          // ุฅุนุงุฏุฉ ุชุนููู ุตูุญุฉ ุงูููู ุงูุดุฎุตู
          const profileInfo = document.querySelector('.profile-info');
          profileInfo.innerHTML = '<p>ูุนูููุงุช ุงููุณุชุฎุฏู ุณุชุธูุฑ ููุง ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู</p>';

          // ุงูุนูุฏุฉ ูุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
          showSection('login-section');

          alert('ุชู ุชุณุฌูู ุงูุฎุฑูุฌ ุจูุฌุงุญ');
        } catch (error) {
          console.error('Logout error:', error);
          alert('ุญุฏุซ ุฎุทุฃ ูู ุชุณุฌูู ุงูุฎุฑูุฌ');
        }
      }
    }

    function showForgotPassword() {
      alert('ุณูุชู ุฅุฑุณุงู ุฑุงุจุท ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ ุฅูู ุจุฑูุฏู ุงูุฅููุชุฑููู');
    }

    // ูุธุงุฆู ุงูุชุณุฌูู
    function showRegisterForm() {
      document.getElementById('main-login-form').classList.add('hidden');
      document.getElementById('register-form').classList.remove('hidden');
    }

    function showLoginForm() {
      document.getElementById('register-form').classList.add('hidden');
      document.getElementById('main-login-form').classList.remove('hidden');
    }

    async function handleRegister(event) {
      event.preventDefault();

      const username = document.getElementById('reg-username').value;
      const email = document.getElementById('reg-email').value;
      const fullname = document.getElementById('reg-fullname').value;
      const password = document.getElementById('reg-password').value;
      const employeeId = document.getElementById('reg-employee-id').value;

      if (!username || !email || !fullname || !password) {
        alert('ูุฑุฌู ููุก ุฌููุน ุงูุญููู ุงููุทููุจุฉ');
        return;
      }

      try {
        const result = await canalAPI.register({
          username: username,
          email: email,
          full_name: fullname,
          password: password,
          employee_id: employeeId,
          department: 'ุนุงู',
          phone: ''
        });

        if (result.success) {
          alert('ุชู ุฅูุดุงุก ุงูุญุณุงุจ ุจูุฌุงุญ! ููููู ุงูุขู ุชุณุฌูู ุงูุฏุฎูู');
          showLoginForm();
          // ููุก ุจูุงูุงุช ุชุณุฌูู ุงูุฏุฎูู
          document.getElementById('main-username').value = username;
        } else {
          alert(result.error || 'ูุดู ูู ุฅูุดุงุก ุงูุญุณุงุจ');
        }
      } catch (error) {
        console.error('Registration error:', error);
        alert('ุญุฏุซ ุฎุทุฃ ูู ุฅูุดุงุก ุงูุญุณุงุจ');
      }
    }

    // ุฅูุดุงุก ุงููุณุชุฎุฏู ุงูุงูุชุฑุงุถู ุฅุฐุง ูู ููู ููุฌูุฏุงู
    async function createDefaultUsers() {
      try {
        // ุฅูุดุงุก ุงููุดุฑู ุงูุงูุชุฑุงุถู
        const adminResult = await canalAPI.register({
          username: 'admin',
          email: 'admin@canalsugar.com',
          full_name: 'ูุฏูุฑ ุงููุธุงู',
          password: 'canal2025',
          employee_id: 'ADMIN001',
          department: 'ุงูุฅุฏุงุฑุฉ',
          phone: ''
        });

        if (adminResult.success) {
          console.log('ุชู ุฅูุดุงุก ุญุณุงุจ ุงููุดุฑู ุงูุงูุชุฑุงุถู');
        }

        // ุฅูุดุงุก ูุณุชุฎุฏู ุชุฌุฑูุจู
        const userResult = await canalAPI.register({
          username: 'user1',
          email: 'user1@canalsugar.com',
          full_name: 'ูุญูุฏ ุฃุญูุฏ',
          password: '123456',
          employee_id: 'EMP001',
          department: 'ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ',
          phone: '0501234567'
        });

        if (userResult.success) {
          console.log('ุชู ุฅูุดุงุก ุงููุณุชุฎุฏู ุงูุชุฌุฑูุจู');
        }

      } catch (error) {
        console.log('ุงููุณุชุฎุฏููู ุงูุงูุชุฑุงุถููู ููุฌูุฏูู ุจุงููุนู ุฃู ุญุฏุซ ุฎุทุฃ:', error);
      }
    }

    // ุงุฎุชุจุงุฑ ุงููุคูุช ูุจุงุดุฑุฉ
    function testTimer() {
      console.log('Testing timer...');

      // ุฅุธูุงุฑ ุงููุคูุช ูุน 5 ุฏูุงุฆู ููุงุฎุชุจุงุฑ
      const timerElement = document.getElementById('meal-timer');
      const timerTitle = document.getElementById('timer-title');

      if (timerElement && timerTitle) {
        timerElement.style.display = 'block';
        timerTitle.textContent = 'ุงุฎุชุจุงุฑ ุงููุคูุช - 5 ุฏูุงุฆู';

        // ุจุฏุก ุนุฏ ุชูุงุฒูู ููุฏุฉ 5 ุฏูุงุฆู
        startCountdownCustom(5);

        alert('ุชู ุจุฏุก ุงุฎุชุจุงุฑ ุงููุคูุช ููุฏุฉ 5 ุฏูุงุฆู');
      } else {
        alert('ุนูุงุตุฑ ุงููุคูุช ุบูุฑ ููุฌูุฏุฉ');
      }
    }

    // ุฅุฌุจุงุฑ ุฅุธูุงุฑ ุงููุคูุช ูููุฌุจุฉ ุงููุดุทุฉ
    function forceShowTimer() {
      const activeMeal = getCurrentActiveMeal();
      console.log('Force showing timer for:', activeMeal);

      if (activeMeal) {
        showTimer(activeMeal, 'remaining');
      } else {
        // ุฅุธูุงุฑ ูุคูุช ูููุฌุจุฉ ุงูุชุงููุฉ
        const nextMeal = getNextMeal();
        if (nextMeal.mealId) {
          showTimer(nextMeal.mealId, 'until_start', nextMeal.minutesUntil);
        } else {
          alert('ูุง ุชูุฌุฏ ูุฌุจุงุช ูุชุงุญุฉ');
        }
      }
    }

    // ุฅูุดุงุก ุญุณุงุจ ุงููุดุฑู ุงูุณุฑูุน
    async function createAdminQuick() {
      try {
        const result = await canalAPI.register({
          username: 'admin',
          email: 'admin@canalsugar.com',
          full_name: 'ูุฏูุฑ ุงููุธุงู',
          password: 'canal2025',
          employee_id: 'ADMIN001',
          department: 'ุงูุฅุฏุงุฑุฉ',
          phone: ''
        });

        if (result.success) {
          alert('ุชู ุฅูุดุงุก ุญุณุงุจ ุงููุดุฑู ุจูุฌุงุญ!\nุงุณู ุงููุณุชุฎุฏู: admin\nูููุฉ ุงููุฑูุฑ: canal2025');
          // ููุก ุจูุงูุงุช ุชุณุฌูู ุงูุฏุฎูู
          document.getElementById('main-username').value = 'admin';
          document.getElementById('main-password').value = 'canal2025';
        } else {
          if (result.error.includes('ููุฌูุฏ ุจุงููุนู')) {
            alert('ุญุณุงุจ ุงููุดุฑู ููุฌูุฏ ุจุงููุนู!\nุงุณู ุงููุณุชุฎุฏู: admin\nูููุฉ ุงููุฑูุฑ: canal2025');
            // ููุก ุจูุงูุงุช ุชุณุฌูู ุงูุฏุฎูู
            document.getElementById('main-username').value = 'admin';
            document.getElementById('main-password').value = 'canal2025';
          } else {
            alert(result.error);
          }
        }
      } catch (error) {
        console.error('Error creating admin:', error);
        alert('ุญุฏุซ ุฎุทุฃ ูู ุฅูุดุงุก ุญุณุงุจ ุงููุดุฑู');
      }
    }

    // ูุธุงุฆู ุงููุดุฑู
    let isAdminLoggedIn = false;
    const ADMIN_CREDENTIALS = {
      username: 'admin',
      password: 'canal2025'
    };

    function handleAdminLogin(event) {
      event.preventDefault();

      const username = document.getElementById('admin-username').value;
      const password = document.getElementById('admin-password').value;

      if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
        isAdminLoggedIn = true;
        document.getElementById('admin-login-container').classList.add('hidden');
        document.getElementById('admin-dashboard').classList.remove('hidden');

        // ุชุญุฏูุซ ูุงุฌูุฉ ุงููุดุฑู
        updateAdminMealsStatusTable();
        updateMealToggleUI();

        alert('ูุฑุญุจุงู ุจู ูู ููุญุฉ ุชุญูู ุงููุดุฑู!');
      } else {
        alert('ุงุณู ุงููุณุชุฎุฏู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ!');
      }
    }

    function logoutAdmin() {
      if (confirm('ูู ุชุฑูุฏ ุชุณุฌูู ุงูุฎุฑูุฌ ูู ููุญุฉ ุงููุดุฑูุ')) {
        isAdminLoggedIn = false;
        document.getElementById('admin-login-container').classList.remove('hidden');
        document.getElementById('admin-dashboard').classList.add('hidden');
        document.getElementById('admin-login-form').reset();
        showSection('home-section');
      }
    }

    // ูุชุบูุฑุงุช ุชุญุฑูุฑ ุงููุฌุจุงุช
    let currentEditingMeal = null;
    let currentEditingImage = null;
    let selectedImagePath = null;

    // ูุธุงุฆู ุชุญุฑูุฑ ุงููุฌุจุงุช
    function editMeal(mealType) {
      currentEditingMeal = mealType;
      const meal = meals[mealType];

      // ููุก ุงููููุฐุฌ ุจุงูุจูุงูุงุช ุงูุญุงููุฉ
      document.getElementById('meal-name-ar').value = meal.name.ar;
      document.getElementById('meal-name-en').value = meal.name.en;
      document.getElementById('meal-desc-ar').value = meal.desc.ar;
      document.getElementById('meal-desc-en').value = meal.desc.en;
      document.getElementById('meal-start-time').value = meal.startTime;
      document.getElementById('meal-end-time').value = meal.endTime;
      document.getElementById('meal-options-ar').value = meal.options.ar.join(', ');
      document.getElementById('meal-options-en').value = meal.options.en.join(', ');

      // ุฅุธูุงุฑ ุงููุงูุฐุฉ
      document.getElementById('edit-meal-modal').classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }

    function closeEditMealModal() {
      document.getElementById('edit-meal-modal').classList.add('hidden');
      document.body.style.overflow = 'auto';
      currentEditingMeal = null;
    }

    function saveMealChanges(event) {
      event.preventDefault();

      if (!currentEditingMeal) return;

      // ุฌูุน ุงูุจูุงูุงุช ูู ุงููููุฐุฌ
      const nameAr = document.getElementById('meal-name-ar').value;
      const nameEn = document.getElementById('meal-name-en').value;
      const descAr = document.getElementById('meal-desc-ar').value;
      const descEn = document.getElementById('meal-desc-en').value;
      const startTime = document.getElementById('meal-start-time').value;
      const endTime = document.getElementById('meal-end-time').value;
      const optionsAr = document.getElementById('meal-options-ar').value.split(',').map(s => s.trim()).filter(s => s);
      const optionsEn = document.getElementById('meal-options-en').value.split(',').map(s => s.trim()).filter(s => s);

      // ุชุญุฏูุซ ุจูุงูุงุช ุงููุฌุจุฉ
      meals[currentEditingMeal] = {
        ...meals[currentEditingMeal],
        name: { ar: nameAr, en: nameEn },
        desc: { ar: descAr, en: descEn },
        startTime: startTime,
        endTime: endTime,
        options: { ar: optionsAr, en: optionsEn }
      };

      // ุชุญุฏูุซ ุงููุงุฌูุฉ
      updateMealDetails(currentEditingMeal);
      updateMealOptions();

      // ุชุญุฏูุซ ูุงุฌูุฉ ุงููุดุฑู
      updateAdminMealDisplay(currentEditingMeal);

      // ุญูุธ ุงูุจูุงูุงุช ูู localStorage
      localStorage.setItem('mealsData', JSON.stringify(meals));

      // ุฅุบูุงู ุงููุงูุฐุฉ
      closeEditMealModal();

      alert('ุชู ุญูุธ ุงูุชุบููุฑุงุช ุจูุฌุงุญ!');

      console.log('Meal updated:', meals[currentEditingMeal]);
    }

    function changeMealImage(mealType) {
      currentEditingImage = mealType;
      selectedImagePath = null;

      // ุฅุนุงุฏุฉ ุชุนููู ุงููุงูุฐุฉ
      document.getElementById('image-preview').style.display = 'none';
      document.getElementById('meal-image-input').value = '';

      // ุฅุธูุงุฑ ุงููุงูุฐุฉ
      document.getElementById('change-image-modal').classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }

    function closeChangeImageModal() {
      document.getElementById('change-image-modal').classList.add('hidden');
      document.body.style.overflow = 'auto';
      currentEditingImage = null;
      selectedImagePath = null;
    }

    function previewImage(event) {
      const file = event.target.files[0];
      if (!file) return;

      // ุงูุชุญูู ูู ููุน ุงูููู
      if (!file.type.startsWith('image/')) {
        alert('ูุฑุฌู ุงุฎุชูุงุฑ ููู ุตูุฑุฉ ุตุงูุญ');
        return;
      }

      // ุงูุชุญูู ูู ุญุฌู ุงูููู (2MB)
      if (file.size > 2 * 1024 * 1024) {
        alert('ุญุฌู ุงูููู ูุจูุฑ ุฌุฏุงู. ูุฑุฌู ุงุฎุชูุงุฑ ุตูุฑุฉ ุฃูู ูู 2MB');
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        document.getElementById('preview-img').src = e.target.result;
        document.getElementById('image-preview').style.display = 'block';
        selectedImagePath = e.target.result; // base64 data
      };
      reader.readAsDataURL(file);
    }

    function removePreview() {
      document.getElementById('image-preview').style.display = 'none';
      document.getElementById('meal-image-input').value = '';
      selectedImagePath = null;
    }

    function selectPredefinedImage(imagePath) {
      selectedImagePath = imagePath;
      document.getElementById('preview-img').src = imagePath;
      document.getElementById('image-preview').style.display = 'block';
      document.getElementById('meal-image-input').value = '';
    }

    function saveImageChanges() {
      if (!currentEditingImage || !selectedImagePath) {
        alert('ูุฑุฌู ุงุฎุชูุงุฑ ุตูุฑุฉ ุฃููุงู');
        return;
      }

      // ุชุญุฏูุซ ูุณุงุฑ ุงูุตูุฑุฉ ูู ุจูุงูุงุช ุงููุฌุจุฉ
      meals[currentEditingImage].img = selectedImagePath;

      // ุชุญุฏูุซ ุงูุตูุฑุฉ ูู ูุงุฌูุฉ ุงููุดุฑู
      const adminImg = document.getElementById(`admin-${currentEditingImage}-img`);
      if (adminImg) {
        adminImg.src = selectedImagePath;
      }

      // ุชุญุฏูุซ ุงูุตูุฑุฉ ูู ุตูุญุฉ ุงููุฌุจุงุช ุฅุฐุง ูุงูุช ููุชูุญุฉ
      if (mealType && mealType.value === currentEditingImage) {
        updateMealDetails(currentEditingImage);
      }

      // ุฅุบูุงู ุงููุงูุฐุฉ
      closeChangeImageModal();

      alert('ุชู ุชุบููุฑ ุงูุตูุฑุฉ ุจูุฌุงุญ!');

      console.log('Image updated for meal:', currentEditingImage, selectedImagePath);
    }

    // ุชุญุฏูุซ ูุงุฌูุฉ ุงููุดุฑู
    function updateAdminMealDisplay(mealType) {
      const meal = meals[mealType];
      const mealItem = document.querySelector(`#admin-${mealType}-img`).closest('.meal-management-item');

      if (mealItem) {
        const nameElement = mealItem.querySelector('h5');
        const timeElement = mealItem.querySelector('.meal-time');

        if (nameElement) nameElement.textContent = meal.name.ar;
        if (timeElement) timeElement.textContent = `${meal.startTime} - ${meal.endTime}`;
      }
    }

    // ุชุญููู ุงูุจูุงูุงุช ุงููุญููุธุฉ
    function loadSavedMealsData() {
      const savedData = localStorage.getItem('mealsData');
      if (savedData) {
        try {
          const parsedData = JSON.parse(savedData);
          // ุฏูุฌ ุงูุจูุงูุงุช ุงููุญููุธุฉ ูุน ุงูุจูุงูุงุช ุงูุงูุชุฑุงุถูุฉ
          Object.keys(meals).forEach(mealType => {
            if (parsedData[mealType]) {
              meals[mealType] = { ...meals[mealType], ...parsedData[mealType] };
            }
          });
          console.log('Loaded saved meals data');
        } catch (error) {
          console.error('Error loading saved meals data:', error);
        }
      }
    }

    // ุฅุนุงุฏุฉ ุชุนููู ุงูุจูุงูุงุช ููุงูุชุฑุงุถูุฉ
    function resetMealsData() {
      if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุฅุนุงุฏุฉ ุชุนููู ุฌููุน ุจูุงูุงุช ุงููุฌุจุงุช ููุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉุ')) {
        localStorage.removeItem('mealsData');
        location.reload(); // ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ
      }
    }

    function getMealName(mealType) {
      const names = {
        breakfast: 'ุงููุทูุฑ ุงูุตุจุงุญู',
        lunch: 'ุงูุบุฏุงุก',
        dinner: 'ุงูุนุดุงุก',
        suhour: 'ุงูุณุญูุฑ'
      };
      return names[mealType] || mealType;
    }

    // ูุชุบูุฑ ูุญูุธ ุญุงูุฉ ุงููุฌุจุงุช ุงููุนุทูุฉ
    let disabledMeals = new Set();

    function toggleMeal() {
      const selectedMeal = document.getElementById('meal-toggle-select').value;
      const mealName = getMealName(selectedMeal);

      if (disabledMeals.has(selectedMeal)) {
        // ุชูุนูู ุงููุฌุจุฉ
        disabledMeals.delete(selectedMeal);
        alert(`ุชู ุชูุนูู ${mealName}`);
      } else {
        // ุชุนุทูู ุงููุฌุจุฉ
        disabledMeals.add(selectedMeal);
        alert(`ุชู ุชุนุทูู ${mealName}`);
      }

      // ุญูุธ ุงูุญุงูุฉ
      localStorage.setItem('disabledMeals', JSON.stringify([...disabledMeals]));

      // ุชุญุฏูุซ ุงููุงุฌูุฉ
      updateMealStatus();
      updateMealToggleUI();
      updateAdminMealsStatusTable();
    }

    function updateMealToggleUI() {
      const selectedMeal = document.getElementById('meal-toggle-select').value;
      const toggleBtn = document.querySelector('.toggle-meal-btn');

      if (toggleBtn) {
        if (disabledMeals.has(selectedMeal)) {
          toggleBtn.textContent = 'ุชูุนูู ุงููุฌุจุฉ';
          toggleBtn.style.background = '#48bb78';
        } else {
          toggleBtn.textContent = 'ุชุนุทูู ุงููุฌุจุฉ';
          toggleBtn.style.background = '#e53e3e';
        }
      }
    }

    function loadDisabledMeals() {
      const saved = localStorage.getItem('disabledMeals');
      if (saved) {
        try {
          disabledMeals = new Set(JSON.parse(saved));
        } catch (error) {
          console.error('Error loading disabled meals:', error);
        }
      }
    }

    function updateAdminMealsStatusTable() {
      const mealTypes = ['breakfast', 'lunch', 'dinner', 'suhour'];

      mealTypes.forEach(mealType => {
        const statusElement = document.getElementById(`${mealType}-status`);
        if (statusElement) {
          if (disabledMeals.has(mealType)) {
            statusElement.textContent = 'ูุนุทู';
            statusElement.className = 'status-inactive';
          } else {
            statusElement.textContent = 'ูุดุท';
            statusElement.className = 'status-active';
          }
        }
      });
    }

    async function exportData() {
      try {
        if (!canalAPI.isAdmin()) {
          alert('ุบูุฑ ูุตุฑุญ ูู ุจูุฐู ุงูุนูููุฉ');
          return;
        }

        const result = await canalAPI.exportData('json');
        if (result.success) {
          // ุฅูุดุงุก ูุชุญููู ุงูููู
          const blob = new Blob([JSON.stringify(result.data, null, 2)],
                               { type: 'application/json' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = result.filename;
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);

          alert('ุชู ุชุตุฏูุฑ ุงูุจูุงูุงุช ุจูุฌุงุญ');
        } else {
          alert(result.error || 'ูุดู ูู ุชุตุฏูุฑ ุงูุจูุงูุงุช');
        }
      } catch (error) {
        console.error('Export error:', error);
        alert('ุญุฏุซ ุฎุทุฃ ูู ุชุตุฏูุฑ ุงูุจูุงูุงุช');
      }
    }

    function resetSystem() {
      if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุฅุนุงุฏุฉ ุชุนููู ุงููุธุงูุ ุณูุชู ุญุฐู ุฌููุน ุงูุจูุงูุงุช!')) {
        alert('ุชู ุฅุนุงุฏุฉ ุชุนููู ุงููุธุงู ุจูุฌุงุญ');
        // ููุง ูููู ุฅุถุงูุฉ ููุทู ุฅุนุงุฏุฉ ุงูุชุนููู
      }
    }

    // ูุชุบูุฑ ูุชูุนูู ูุถุน ุงูุงุฎุชุจุงุฑ
    let testMode = false;
    let testTime = null;

    // ุฏุงูุฉ ูุชูุนูู ูุถุน ุงูุงุฎุชุจุงุฑ (ูููุดุฑู)
    function enableTestMode() {
      testMode = true;
      const now = new Date();
      // ุชุนููู ููุช ุงุฎุชุจุงุฑ (ูุซูุงู ุงูุณุงุนุฉ 12:30 ููุบุฏุงุก)
      testTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 12, 30, 0);
      console.log('Test mode enabled. Test time set to:', testTime.toLocaleTimeString());
      updateMealStatus();
    }

    function disableTestMode() {
      testMode = false;
      testTime = null;
      console.log('Test mode disabled');
      updateMealStatus();
    }

    function setTestTime(mealType) {
      if (!testMode) {
        enableTestMode();
      }

      const meal = meals[mealType];
      const now = new Date();
      const [hours, minutes] = meal.startTime.split(':').map(Number);

      // ุชุนููู ุงูููุช ูุจุฏุงูุฉ ุงููุฌุจุฉ + 5 ุฏูุงุฆู
      testTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), hours, minutes + 5, 0);

      console.log(`Test time set for ${mealType}:`, testTime.toLocaleTimeString());
      updateMealStatus();
    }

    // ุชุนุฏูู ุฏุงูุฉ getCurrentTime ูุฏุนู ูุถุน ุงูุงุฎุชุจุงุฑ
    function getCurrentTime() {
      return testMode && testTime ? testTime : new Date();
    }

    // ุจุฏุก ูุธุงู ุงูุชูููุช
    function startTimeSystem() {
      // ุชุญุฏูุซ ุงูููุช ูู ุซุงููุฉ
      timeUpdateInterval = setInterval(() => {
        updateCurrentTimeDisplay();
        updateMealStatus();

        // ูู ูุถุน ุงูุงุฎุชุจุงุฑุ ุชูุฏู ุงูููุช ุจุฏูููุฉ ูุงุญุฏุฉ ูู ุซุงููุฉ
        if (testMode && testTime) {
          testTime.setMinutes(testTime.getMinutes() + 1);
        }
      }, 1000);

      // ุชุญุฏูุซ ููุฑู
      updateCurrentTimeDisplay();
      updateMealStatus();
    }

    // ุฅููุงู ูุธุงู ุงูุชูููุช
    function stopTimeSystem() {
      if (timeUpdateInterval) {
        clearInterval(timeUpdateInterval);
      }
      if (timerInterval) {
        clearInterval(timerInterval);
      }
    }

    // ุชููุฆุฉ ุงูุชุทุจูู
    async function initializeApp() {
      try {
        // ุชููุฆุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช
        const dbSuccess = await canalAPI.init();
        if (dbSuccess) {
          console.log('ุชู ุชููุฆุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจูุฌุงุญ');

          // ุฅูุดุงุก ุงููุณุชุฎุฏููู ุงูุงูุชุฑุงุถููู
          await createDefaultUsers();

          // ุชุญููู ุงููุฌุจุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
          await loadMealsFromDatabase();
        } else {
          console.warn('ูุดู ูู ุชููุฆุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุชุ ุณูุชู ุงุณุชุฎุฏุงู ุงูุจูุงูุงุช ุงููุญููุฉ');
        }

        loadSavedMealsData(); // ุชุญููู ุจูุงูุงุช ุงููุฌุจุงุช ุงููุญููุธุฉ
        loadDisabledMeals(); // ุชุญููู ุงููุฌุจุงุช ุงููุนุทูุฉ
        loadSavedLanguage(); // ุชุญููู ุงููุบุฉ ุงููุญููุธุฉ
        showSection('login-section');
        startTimeSystem(); // ุจุฏุก ูุธุงู ุงูุชูููุช

        console.log('ุชู ุชููุฆุฉ ุงูุชุทุจูู ุจูุฌุงุญ');
      } catch (error) {
        console.error('ุฎุทุฃ ูู ุชููุฆุฉ ุงูุชุทุจูู:', error);
        // ุงููุชุงุจุนุฉ ุจุงูุจูุงูุงุช ุงููุญููุฉ
        loadSavedMealsData();
        loadDisabledMeals();
        loadSavedLanguage();
        showSection('login-section');
        startTimeSystem();
      }
    }

    // ุชุญููู ุงููุฌุจุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
    async function loadMealsFromDatabase() {
      try {
        const result = await canalAPI.getAvailableMeals();
        if (result.success && result.meals.length > 0) {
          // ุชุญุฏูุซ ุจูุงูุงุช ุงููุฌุจุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
          result.meals.forEach(dbMeal => {
            if (meals[dbMeal.meal_type]) {
              meals[dbMeal.meal_type] = {
                ...meals[dbMeal.meal_type],
                name: {
                  ar: dbMeal.name_ar,
                  en: dbMeal.name_en
                },
                desc: {
                  ar: dbMeal.description_ar,
                  en: dbMeal.description_en
                },
                img: dbMeal.image_path,
                startTime: dbMeal.start_time,
                endTime: dbMeal.end_time
              };
            }
          });
          console.log('ุชู ุชุญููู ุงููุฌุจุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช');
        }
      } catch (error) {
        console.error('ุฎุทุฃ ูู ุชุญููู ุงููุฌุจุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:', error);
      }
    }

    // ุชุญููู ุญุฌูุฒุงุช ุงููุณุชุฎุฏู
    async function loadUserReservations() {
      try {
        if (!canalAPI.isLoggedIn()) {
          document.getElementById('reservations-list').innerHTML =
            '<p class="no-reservations">ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู ูุนุฑุถ ุงูุญุฌูุฒุงุช</p>';
          return;
        }

        const result = await canalAPI.getUserReservations();
        const reservationsList = document.getElementById('reservations-list');

        if (result.success) {
          if (result.reservations.length === 0) {
            reservationsList.innerHTML = '<p class="no-reservations">ูุง ุชูุฌุฏ ุญุฌูุฒุงุช ุญุงููุงู</p>';
          } else {
            let html = '<div class="reservations-grid">';

            for (const reservation of result.reservations) {
              const reservationDate = new Date(reservation.reservation_date).toLocaleDateString('ar-SA');
              const reservationTime = new Date(reservation.reservation_time).toLocaleTimeString('ar-SA', {
                hour: '2-digit',
                minute: '2-digit'
              });

              html += `
                <div class="reservation-card">
                  <div class="reservation-header">
                    <h4>ุญุฌุฒ ุฑูู: ${reservation.id}</h4>
                    <span class="reservation-status status-${reservation.status}">${reservation.status}</span>
                  </div>
                  <div class="reservation-details">
                    <p><strong>ุงูุชุงุฑูุฎ:</strong> ${reservationDate}</p>
                    <p><strong>ุงูููุช:</strong> ${reservationTime}</p>
                    <p><strong>ูุนุฑู ุงููุฌุจุฉ:</strong> ${reservation.meal_id}</p>
                    ${reservation.notes ? `<p><strong>ููุงุญุธุงุช:</strong> ${reservation.notes}</p>` : ''}
                  </div>
                  <div class="reservation-actions">
                    ${reservation.status === 'confirmed' ?
                      `<button class="cancel-reservation-btn" onclick="cancelReservation(${reservation.id})">ุฅูุบุงุก ุงูุญุฌุฒ</button>` :
                      ''
                    }
                  </div>
                </div>
              `;
            }

            html += '</div>';
            reservationsList.innerHTML = html;
          }
        } else {
          reservationsList.innerHTML = `<p class="error-message">ุฎุทุฃ: ${result.error}</p>`;
        }
      } catch (error) {
        console.error('Error loading reservations:', error);
        document.getElementById('reservations-list').innerHTML =
          '<p class="error-message">ุญุฏุซ ุฎุทุฃ ูู ุชุญููู ุงูุญุฌูุฒุงุช</p>';
      }
    }

    // ุฅูุบุงุก ุญุฌุฒ
    async function cancelReservation(reservationId) {
      if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุฅูุบุงุก ูุฐุง ุงูุญุฌุฒุ')) {
        try {
          const result = await canalAPI.cancelReservation(reservationId);
          if (result.success) {
            alert('ุชู ุฅูุบุงุก ุงูุญุฌุฒ ุจูุฌุงุญ');
            loadUserReservations(); // ุฅุนุงุฏุฉ ุชุญููู ุงููุงุฆูุฉ
          } else {
            alert(result.error || 'ูุดู ูู ุฅูุบุงุก ุงูุญุฌุฒ');
          }
        } catch (error) {
          console.error('Cancel reservation error:', error);
          alert('ุญุฏุซ ุฎุทุฃ ูู ุฅูุบุงุก ุงูุญุฌุฒ');
        }
      }
    }

    // ุชุญููู ุงูุญุฌูุฒุงุช ุนูุฏ ูุชุญ ุงูุตูุญุฉ
    function showSection(sectionId) {
      console.log('๐ ูุชุญ ุงููุณู:', sectionId);

      // ุงูุชุญูู ูู ุชุณุฌูู ุงูุฏุฎูู ูุจู ุงููุตูู ููุตูุญุงุช ุงููุญููุฉ
      if (!isLoggedIn && sectionId !== 'login-section') {
        alert('ูุฑุฌู ุชุณุฌูู ุงูุฏุฎูู ุฃููุงู');
        return;
      }

      // ุฅุฎูุงุก ุฌููุน ุงูุฃูุณุงู
      const sections = document.querySelectorAll('main section');
      sections.forEach(section => {
        section.classList.add('hidden');
      });

      // ุฅุธูุงุฑ ุงููุณู ุงููุทููุจ
      const targetSection = document.getElementById(sectionId);
      if (targetSection) {
        targetSection.classList.remove('hidden');
        console.log('โ ุชู ุฅุธูุงุฑ ุงููุณู:', sectionId);
      } else {
        console.error('โ ุงููุณู ุบูุฑ ููุฌูุฏ:', sectionId);
        return;
      }

      // ุชุญููู ุงูุจูุงูุงุช ุญุณุจ ุงููุณู
      if (sectionId === 'reservations-section') {
        console.log('๐ ุชุญููู ุงูุญุฌูุฒุงุช...');
        loadUserReservations();
      } else if (sectionId === 'meals-section') {
        console.log('๐ฝ๏ธ ุชููุฆุฉ ุตูุญุฉ ุงููุฌุจุงุช...');
        // ุชุฃุฎูุฑ ูุตูุฑ ููุชุฃูุฏ ูู ุธููุฑ ุงูุนูุงุตุฑ
        setTimeout(() => {
          initializeMealsSection();
        }, 100);
      }
    }

    // ุชููุฆุฉ ุตูุญุฉ ุงููุฌุจุงุช
    function initializeMealsSection() {
      console.log('๐ ุจุฏุก ุชููุฆุฉ ุตูุญุฉ ุงููุฌุจุงุช...');

      try {
        // ุงูุชุฃูุฏ ูู ูุฌูุฏ ุนูุตุฑ ููุน ุงููุฌุจุฉ
        const mealTypeSelect = document.getElementById('meal-type');
        if (!mealTypeSelect) {
          console.error('โ ุนูุตุฑ ุงุฎุชูุงุฑ ููุน ุงููุฌุจุฉ ุบูุฑ ููุฌูุฏ');
          return;
        }

        // ุงูุชุญูู ูู ูุฌูุฏ ุจูุงูุงุช ุงููุฌุจุงุช
        if (!meals || Object.keys(meals).length === 0) {
          console.error('โ ุจูุงูุงุช ุงููุฌุจุงุช ุบูุฑ ููุฌูุฏุฉ');
          return;
        }

        // ุชุญุฏูุซ ุชูุงุตูู ุงููุฌุจุฉ ุงูุงูุชุฑุงุถูุฉ
        const defaultMeal = mealTypeSelect.value || 'breakfast';
        console.log('๐ ุชุญููู ุงููุฌุจุฉ ุงูุงูุชุฑุงุถูุฉ:', defaultMeal);

        // ุงูุชุฃูุฏ ูู ูุฌูุฏ ุงููุฌุจุฉ ุงููุฎุชุงุฑุฉ
        if (!meals[defaultMeal]) {
          console.warn('โ๏ธ ุงููุฌุจุฉ ุงููุฎุชุงุฑุฉ ุบูุฑ ููุฌูุฏุฉุ ุงุณุชุฎุฏุงู ุงููุทูุฑ');
          mealTypeSelect.value = 'breakfast';
        }

        // ุชุญุฏูุซ ุชูุงุตูู ุงููุฌุจุฉ
        updateMealDetails(mealTypeSelect.value);

        // ุชุญุฏูุซ ุญุงูุฉ ุงููุฌุจุฉ ูุงููุคูุช
        updateMealStatus();

        // ุฅุถุงูุฉ ูุณุชูุน ูุชุบููุฑ ููุน ุงููุฌุจุฉ
        mealTypeSelect.onchange = function() {
          console.log('๐ ุชุบููุฑ ููุน ุงููุฌุจุฉ ุฅูู:', this.value);
          updateMealDetails(this.value);
        };

        console.log('โ ุชู ุชููุฆุฉ ุตูุญุฉ ุงููุฌุจุงุช ุจูุฌุงุญ');

      } catch (error) {
        console.error('โ ุฎุทุฃ ูู ุชููุฆุฉ ุตูุญุฉ ุงููุฌุจุงุช:', error);
      }
    }

    // ุฅุฌุจุงุฑ ุชุญุฏูุซ ุตูุญุฉ ุงููุฌุจุงุช
    function forceRefreshMealsSection() {
      console.log('๐ ุฅุฌุจุงุฑ ุชุญุฏูุซ ุตูุญุฉ ุงููุฌุจุงุช...');

      // ุฅุนุงุฏุฉ ุชุนููู ุงููุญุชูู
      const mealName = document.getElementById('meal-name');
      const mealDesc = document.getElementById('meal-desc');
      const mealImg = document.getElementById('meal-img');
      const mealOptions = document.getElementById('meal-options');

      if (mealName) mealName.textContent = 'ุฌุงุฑู ุงูุชุญููู...';
      if (mealDesc) mealDesc.textContent = 'ุฌุงุฑู ุชุญููู ุชูุงุตูู ุงููุฌุจุฉ...';
      if (mealOptions) mealOptions.innerHTML = '<p>ุฌุงุฑู ุงูุชุญููู...</p>';

      // ุชุฃุฎูุฑ ูุตูุฑ ุซู ุฅุนุงุฏุฉ ุงูุชููุฆุฉ
      setTimeout(() => {
        initializeMealsSection();
      }, 100);
    }

    // ุชุดุฎูุต ุดุงูู ูุตูุญุฉ ุงููุฌุจุงุช
    function debugMealsSection() {
      console.log('๐ ุจุฏุก ุชุดุฎูุต ุตูุญุฉ ุงููุฌุจุงุช...');

      const report = {
        elements: {},
        data: {},
        status: {}
      };

      // ูุญุต ุงูุนูุงุตุฑ
      const elements = [
        'meal-name', 'meal-desc', 'meal-img', 'meal-options',
        'meal-time-range', 'meal-type', 'meal-timer', 'reserve-btn'
      ];

      elements.forEach(id => {
        const element = document.getElementById(id);
        report.elements[id] = {
          exists: !!element,
          visible: element ? !element.classList.contains('hidden') : false,
          content: element ? (element.textContent || element.value || element.src || 'empty') : null
        };
      });

      // ูุญุต ุงูุจูุงูุงุช
      report.data = {
        mealsExists: !!meals,
        mealsCount: meals ? Object.keys(meals).length : 0,
        currentLanguage: currentLanguage,
        isLoggedIn: isLoggedIn,
        currentUser: currentUser
      };

      // ูุญุต ุงูุญุงูุฉ
      report.status = {
        activeMeal: getCurrentActiveMeal(),
        testMode: testMode || false,
        timerRunning: !!timerInterval
      };

      console.log('๐ ุชูุฑูุฑ ุงูุชุดุฎูุต:', report);

      // ุนุฑุถ ุงูุชูุฑูุฑ ูู alert
      let message = '๐ ุชูุฑูุฑ ุชุดุฎูุต ุตูุญุฉ ุงููุฌุจุงุช:\n\n';

      message += '๐ ุงูุนูุงุตุฑ:\n';
      Object.entries(report.elements).forEach(([id, info]) => {
        const status = info.exists ? (info.visible ? 'โ' : 'โ๏ธ') : 'โ';
        message += `${status} ${id}: ${info.exists ? 'ููุฌูุฏ' : 'ููููุฏ'}\n`;
      });

      message += '\n๐ ุงูุจูุงูุงุช:\n';
      message += `ุงููุฌุจุงุช: ${report.data.mealsExists ? report.data.mealsCount + ' ูุฌุจุฉ' : 'ููููุฏุฉ'}\n`;
      message += `ุงููุบุฉ: ${report.data.currentLanguage}\n`;
      message += `ุชุณุฌูู ุงูุฏุฎูู: ${report.data.isLoggedIn ? 'ูุนู' : 'ูุง'}\n`;

      message += '\nโก ุงูุญุงูุฉ:\n';
      message += `ุงููุฌุจุฉ ุงููุดุทุฉ: ${report.status.activeMeal || 'ูุง ุชูุฌุฏ'}\n`;
      message += `ูุถุน ุงูุงุฎุชุจุงุฑ: ${report.status.testMode ? 'ููุนู' : 'ูุนุทู'}\n`;
      message += `ุงููุคูุช: ${report.status.timerRunning ? 'ูุนูู' : 'ูุชููู'}\n`;

      alert(message);

      return report;
    }

    // ุงูุชุฃูุฏ ูู ุจุฏุก ุงูุชุทุจูู ุจุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
    document.addEventListener('DOMContentLoaded', initializeApp);

    // ุจูุงูุงุช ุงููุฌุจุงุช ูุน ุงูุชูููุชุงุช ูุงูุฎูุงุฑุงุช (ูุชุนุฏุฏุฉ ุงููุบุงุช)
    const meals = {
      breakfast: {
        name: {
          ar: "ูุทูุฑ ุตุจุงุญู",
          en: "Breakfast"
        },
        desc: {
          ar: "ูุฌุจุฉ ุตุจุงุญูุฉ ุบููุฉ ุจุงูุทุงูุฉุ ูุชุงุญุฉ ูู ุงูุณุงุนุฉ 6:00 ุฅูู 9:00 ุตุจุงุญุงู.",
          en: "Energy-rich morning meal, available from 6:00 AM to 9:00 AM."
        },
        img: "images/breakfast.svg",
        startTime: "06:00",
        endTime: "09:00",
        options: {
          ar: ["ุงุฎุชูุงุฑ"],
          en: ["Choice"]
        }
      },
      lunch: {
        name: {
          ar: "ุบุฏุงุก",
          en: "Lunch"
        },
        desc: {
          ar: "ูุฌุจุฉ ุบุฏุงุก ุณุงุฎูุฉ ุฃู ุตุญูุฉ ุฃู ุจุฏููุฉุ ูุชุงุญุฉ ูู ุงูุณุงุนุฉ 12:00 ุฅูู 1:00 ูุณุงุกู.",
          en: "Hot, healthy, or alternative lunch meal, available from 12:00 PM to 1:00 PM."
        },
        img: "images/lunch.svg",
        startTime: "12:00",
        endTime: "13:00",
        options: {
          ar: ["ุณุงุฎู", "ุจุฏูู", "ุตุญู"],
          en: ["Hot", "Alternative", "Healthy"]
        }
      },
      dinner: {
        name: {
          ar: "ุนุดุงุก",
          en: "Dinner"
        },
        desc: {
          ar: "ูุฌุจุฉ ุนุดุงุก ุฎูููุฉ ุฃู ุตุญูุฉุ ูุชุงุญุฉ ูู ุงูุณุงุนุฉ 6:00 ุฅูู 8:00 ูุณุงุกู.",
          en: "Light or healthy dinner meal, available from 6:00 PM to 8:00 PM."
        },
        img: "images/dinner.svg",
        startTime: "18:00",
        endTime: "20:00",
        options: {
          ar: ["ุฎููู", "ุตุญู"],
          en: ["Light", "Healthy"]
        }
      },
      suhour: {
        name: {
          ar: "ุณุญูุฑ",
          en: "Suhour"
        },
        desc: {
          ar: "ูุฌุจุฉ ุณุญูุฑ ุฎูููุฉ ูุตุญูุฉุ ูุชุงุญุฉ ูู ุงูุณุงุนุฉ 3:00 ุฅูู 5:00 ูุฌุฑุงู.",
          en: "Light and healthy suhour meal, available from 3:00 AM to 5:00 AM."
        },
        img: "images/suhour.svg",
        startTime: "03:00",
        endTime: "05:00",
        options: {
          ar: ["ุฎููู", "ุตุญู"],
          en: ["Light", "Healthy"]
        }
      }
    };

    // ูุชุบูุฑุงุช ูุธุงู ุงูุชูููุช
    let currentActiveMeal = null;
    let timerInterval = null;
    let timeUpdateInterval = null;

    // ุนูุงุตุฑ ุงูุตูุญุฉ
    const mealType = document.getElementById('meal-type');
    const mealImg = document.getElementById('meal-img');
    const mealName = document.getElementById('meal-name');
    const mealDesc = document.getElementById('meal-desc');
    const mealOptions = document.getElementById('meal-options');

    // ูุธุงุฆู ูุธุงู ุงูุชูููุช
    function getCurrentTime() {
      return new Date();
    }

    function timeToMinutes(timeStr) {
      const [hours, minutes] = timeStr.split(':').map(Number);
      return hours * 60 + minutes;
    }

    function minutesToTime(minutes) {
      const hours = Math.floor(minutes / 60);
      const mins = minutes % 60;
      return `${hours.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}`;
    }

    function getCurrentActiveMeal() {
      const now = getCurrentTime();
      const currentMinutes = now.getHours() * 60 + now.getMinutes();

      console.log('Checking active meal at:', now.toLocaleTimeString(), 'Minutes:', currentMinutes);

      for (const [mealId, meal] of Object.entries(meals)) {
        // ุชุฎุทู ุงููุฌุจุงุช ุงููุนุทูุฉ
        if (disabledMeals.has(mealId)) {
          console.log(`${mealId}: disabled, skipping`);
          continue;
        }

        const startMinutes = timeToMinutes(meal.startTime);
        const endMinutes = timeToMinutes(meal.endTime);

        console.log(`${mealId}: ${meal.startTime} (${startMinutes}) - ${meal.endTime} (${endMinutes})`);

        // ูุนุงูุฌุฉ ุงูุฃููุงุช ุงูุชู ุชูุชุฏ ุนุจุฑ ููุชุตู ุงูููู (ูุซู ุงูุณุญูุฑ)
        if (startMinutes > endMinutes) {
          // ุงูููุช ููุชุฏ ุนุจุฑ ููุชุตู ุงูููู
          if (currentMinutes >= startMinutes || currentMinutes <= endMinutes) {
            console.log(`Active meal found: ${mealId} (crosses midnight)`);
            return mealId;
          }
        } else {
          // ุงูููุช ุงูุนุงุฏู ูู ููุณ ุงูููู
          if (currentMinutes >= startMinutes && currentMinutes <= endMinutes) {
            console.log(`Active meal found: ${mealId} (same day)`);
            return mealId;
          }
        }
      }

      console.log('No active meal found');
      return null;
    }

    function getNextMeal() {
      const now = getCurrentTime();
      const currentMinutes = now.getHours() * 60 + now.getMinutes();
      let nextMeal = null;
      let minTimeDiff = Infinity;

      for (const [mealId, meal] of Object.entries(meals)) {
        const startMinutes = timeToMinutes(meal.startTime);
        let timeDiff;

        if (startMinutes > currentMinutes) {
          timeDiff = startMinutes - currentMinutes;
        } else {
          timeDiff = (24 * 60) - currentMinutes + startMinutes;
        }

        if (timeDiff < minTimeDiff) {
          minTimeDiff = timeDiff;
          nextMeal = mealId;
        }
      }

      return { mealId: nextMeal, minutesUntil: minTimeDiff };
    }

    function updateCurrentTimeDisplay() {
      const timeDisplay = document.getElementById('current-time-display');
      if (!timeDisplay) return; // ุงูุนูุตุฑ ุบูุฑ ููุฌูุฏ

      const now = getCurrentTime();
      const timeStr = now.toLocaleTimeString('ar-SA', {
        hour: '2-digit',
        minute: '2-digit',
        hour12: false
      });

      // ุฅุถุงูุฉ ูุคุดุฑ ูุถุน ุงูุงุฎุชุจุงุฑ
      const displayText = testMode ? `${timeStr} (ุงุฎุชุจุงุฑ)` : timeStr;
      timeDisplay.textContent = displayText;
    }

    function updateMealStatus() {
      // ุงูุชุญูู ูู ูุฌูุฏ ุงูุนูุงุตุฑ ุงููุทููุจุฉ
      const statusElement = document.getElementById('meal-status-text');
      const timerElement = document.getElementById('meal-timer');
      const reserveBtn = document.getElementById('reserve-btn');

      if (!statusElement || !reserveBtn) {
        console.log('Meal status elements not found, skipping update');
        return; // ุงูุนูุงุตุฑ ุบูุฑ ููุฌูุฏุฉ (ุฑุจูุง ูุณูุง ูู ุตูุญุฉ ุงููุฌุจุงุช)
      }

      const activeMeal = getCurrentActiveMeal();
      const texts = translations[currentLanguage];

      console.log('Current time:', new Date().toLocaleTimeString());
      console.log('Active meal:', activeMeal);

      if (activeMeal) {
        currentActiveMeal = activeMeal;
        statusElement.textContent = `${texts.meal_available} - ${meals[activeMeal].name[currentLanguage]}`;
        statusElement.className = 'status-available';

        // ุชุญุฏูุซ ุงููุงุฆูุฉ ุงูููุณุฏูุฉ ูููุฌุจุฉ ุงููุดุทุฉ
        if (mealType) {
          mealType.value = activeMeal;
          updateMealDetails(activeMeal);
        }

        // ุชูุนูู ุฒุฑ ุงูุญุฌุฒ
        reserveBtn.disabled = false;
        reserveBtn.textContent = texts.book_now;
        reserveBtn.style.opacity = '1';
        reserveBtn.style.cursor = 'pointer';

        // ุฅุธูุงุฑ ุงููุคูุช ููููุช ุงููุชุจูู
        console.log('Calling showTimer for active meal:', activeMeal);
        showTimer(activeMeal, 'remaining');

      } else {
        currentActiveMeal = null;
        statusElement.textContent = texts.meal_not_available;
        statusElement.className = 'status-unavailable';

        // ุชุนุทูู ุฒุฑ ุงูุญุฌุฒ
        reserveBtn.disabled = true;
        reserveBtn.textContent = texts.booking_disabled;
        reserveBtn.style.opacity = '0.6';
        reserveBtn.style.cursor = 'not-allowed';

        // ุฅุธูุงุฑ ูุคูุช ูููุฌุจุฉ ุงูุชุงููุฉ
        const nextMeal = getNextMeal();
        if (nextMeal.mealId) {
          showTimer(nextMeal.mealId, 'until_start', nextMeal.minutesUntil);
        }
      }
    }

    function showTimer(mealId, type, customMinutes = null) {
      console.log('showTimer called:', { mealId, type, customMinutes });

      const timerElement = document.getElementById('meal-timer');
      const timerTitle = document.getElementById('timer-title');
      const texts = translations[currentLanguage];

      // ุงูุชุญูู ูู ูุฌูุฏ ุงูุนูุงุตุฑ
      if (!timerElement || !timerTitle) {
        console.error('Timer elements not found:', { timerElement, timerTitle });
        return;
      }

      console.log('Showing timer for:', mealId, 'type:', type);
      timerElement.style.display = 'block';

      if (type === 'remaining') {
        timerTitle.textContent = texts.time_remaining || 'ุงูููุช ุงููุชุจูู';
        console.log('Starting countdown to end for meal:', mealId);
        startCountdownToEnd(mealId);
      } else if (type === 'until_start') {
        timerTitle.textContent = texts.time_until_start || 'ุงูููุช ุญุชู ุงููุฌุจุฉ ุงูุชุงููุฉ';
        if (customMinutes) {
          console.log('Starting custom countdown:', customMinutes, 'minutes');
          startCountdownCustom(customMinutes);
        } else {
          console.log('Starting countdown to start for meal:', mealId);
          startCountdownToStart(mealId);
        }
      }
    }

    // ุงูุนุฏ ุงูุชูุงุฒูู ุญุชู ููุงูุฉ ุงููุฌุจุฉ
    function startCountdownToEnd(mealId) {
      console.log('startCountdownToEnd called for:', mealId);

      if (timerInterval) {
        console.log('Clearing existing timer interval');
        clearInterval(timerInterval);
      }

      const meal = meals[mealId];
      if (!meal) {
        console.error('Meal not found:', mealId);
        return;
      }

      console.log('Meal details:', meal);

      timerInterval = setInterval(() => {
        const now = getCurrentTime();
        const currentMinutes = now.getHours() * 60 + now.getMinutes() + (now.getSeconds() / 60);

        const targetMinutes = timeToMinutes(meal.endTime);
        let diffMinutes = targetMinutes - currentMinutes;

        console.log('Timer calculation:', {
          currentTime: now.toLocaleTimeString(),
          currentMinutes: currentMinutes.toFixed(2),
          endTime: meal.endTime,
          targetMinutes: targetMinutes,
          diffMinutes: diffMinutes.toFixed(2)
        });

        // ูุนุงูุฌุฉ ุงูุฃููุงุช ุนุจุฑ ููุชุตู ุงูููู
        if (diffMinutes < 0) {
          diffMinutes += 24 * 60;
          console.log('Adjusted for midnight crossing:', diffMinutes.toFixed(2));
        }

        if (diffMinutes <= 0 || diffMinutes > 23 * 60) {
          console.log('Timer ended, clearing interval');
          clearInterval(timerInterval);
          updateMealStatus(); // ุฅุนุงุฏุฉ ุชุญุฏูุซ ุงูุญุงูุฉ
          return;
        }

        updateTimerDisplay(diffMinutes);
      }, 1000);

      console.log('Timer interval started');
    }

    // ุงูุนุฏ ุงูุชูุงุฒูู ุญุชู ุจุฏุงูุฉ ุงููุฌุจุฉ
    function startCountdownToStart(mealId) {
      if (timerInterval) clearInterval(timerInterval);

      timerInterval = setInterval(() => {
        const now = getCurrentTime();
        const currentMinutes = now.getHours() * 60 + now.getMinutes() + (now.getSeconds() / 60);
        const meal = meals[mealId];

        if (!meal) {
          clearInterval(timerInterval);
          return;
        }

        const targetMinutes = timeToMinutes(meal.startTime);
        let diffMinutes = targetMinutes - currentMinutes;

        // ูุนุงูุฌุฉ ุงูุฃููุงุช ุนุจุฑ ููุชุตู ุงูููู
        if (diffMinutes < 0) {
          diffMinutes += 24 * 60;
        }

        if (diffMinutes <= 0) {
          clearInterval(timerInterval);
          updateMealStatus(); // ุฅุนุงุฏุฉ ุชุญุฏูุซ ุงูุญุงูุฉ
          return;
        }

        updateTimerDisplay(diffMinutes);
      }, 1000);
    }

    function startCountdownCustom(totalMinutes) {
      if (timerInterval) clearInterval(timerInterval);

      const startTime = Date.now();
      const endTime = startTime + (totalMinutes * 60 * 1000);

      timerInterval = setInterval(() => {
        const now = Date.now();
        const remaining = endTime - now;

        if (remaining <= 0) {
          clearInterval(timerInterval);
          updateMealStatus();
          return;
        }

        const remainingMinutes = remaining / (1000 * 60);
        updateTimerDisplay(remainingMinutes);
      }, 1000);
    }

    function updateTimerDisplay(totalMinutes) {
      const hours = Math.floor(totalMinutes / 60);
      const minutes = Math.floor(totalMinutes % 60);
      const seconds = Math.floor((totalMinutes * 60) % 60);

      // ุงูุชุญูู ูู ูุฌูุฏ ุงูุนูุงุตุฑ
      const hoursElement = document.getElementById('hours');
      const minutesElement = document.getElementById('minutes');
      const secondsElement = document.getElementById('seconds');

      if (hoursElement) hoursElement.textContent = hours.toString().padStart(2, '0');
      if (minutesElement) minutesElement.textContent = minutes.toString().padStart(2, '0');
      if (secondsElement) secondsElement.textContent = seconds.toString().padStart(2, '0');

      console.log(`Timer: ${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`);
    }

    // ุฏุงูุฉ ูุชุญุฏูุซ ุชูุงุตูู ุงููุฌุจุฉ
    function updateMealDetails(selected) {
      console.log('๐ updateMealDetails called with:', selected);

      // ุงูุญุตูู ุนูู ุงูุนูุงุตุฑ
      const mealName = document.getElementById('meal-name');
      const mealDesc = document.getElementById('meal-desc');
      const mealImg = document.getElementById('meal-img');
      const mealOptions = document.getElementById('meal-options');
      const mealTimeRange = document.getElementById('meal-time-range');

      // ุงูุชุญูู ูู ูุฌูุฏ ุงูุนูุงุตุฑ
      if (!mealName || !mealDesc || !mealImg || !mealOptions) {
        console.error('โ ุนูุงุตุฑ ุงููุฌุจุฉ ุบูุฑ ููุฌูุฏุฉ:', {
          mealName: !!mealName,
          mealDesc: !!mealDesc,
          mealImg: !!mealImg,
          mealOptions: !!mealOptions
        });

        // ูุญุงููุฉ ุฅูุดุงุก ุงูุนูุงุตุฑ ุฅุฐุง ูู ุชูู ููุฌูุฏุฉ
        if (!mealName) console.error('โ meal-name element missing');
        if (!mealDesc) console.error('โ meal-desc element missing');
        if (!mealImg) console.error('โ meal-img element missing');
        if (!mealOptions) console.error('โ meal-options element missing');

        return;
      }

      const meal = meals[selected];
      if (!meal) {
        console.error('โ ุงููุฌุจุฉ ุบูุฑ ููุฌูุฏุฉ:', selected);
        console.log('๐ ุงููุฌุจุงุช ุงููุชุงุญุฉ:', Object.keys(meals));
        return;
      }

      const lang = currentLanguage || 'ar';
      console.log('โ ุชุญุฏูุซ ุชูุงุตูู ุงููุฌุจุฉ:', {
        selected,
        mealName: meal.name[lang],
        lang
      });

      try {
        // ุชุญุฏูุซ ุงููุตูุต
        mealName.textContent = meal.name[lang] || meal.name.ar || 'ุงุณู ุงููุฌุจุฉ';
        mealDesc.textContent = meal.desc[lang] || meal.desc.ar || 'ูุตู ุงููุฌุจุฉ';

        // ุชุญุฏูุซ ุงูุตูุฑุฉ
        mealImg.src = meal.img || 'images/default-meal.svg';
        mealImg.alt = meal.name[lang] || 'ุตูุฑุฉ ุงููุฌุจุฉ';

        // ุนุฑุถ ุชูููุช ุงููุฌุจุฉ
        const timeRange = `${meal.startTime} - ${meal.endTime}`;
        if (mealTimeRange) {
          mealTimeRange.textContent = timeRange;
        }

        // ูุนุงูุฌุฉ ุฎุทุฃ ุชุญููู ุงูุตูุฑุฉ
        mealImg.onerror = function() {
          console.warn('โ๏ธ ูุดู ุชุญููู ุตูุฑุฉ ุงููุฌุจุฉ:', meal.img);
          this.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDMwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjZjNmNGY2Ii8+CjxwYXRoIGQ9Ik0xMjUgNzVMMTc1IDEyNUgxMDBMMTI1IDc1WiIgZmlsbD0iIzlDQTNBRiIvPgo8Y2lyY2xlIGN4PSIxMjUiIGN5PSI3NSIgcj0iMTAiIGZpbGw9IiM5Q0EzQUYiLz4KPHR5cGUgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmaWxsPSIjNjM3MzgwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSIxNTAiIHk9IjE2MCI+2LXZiNix2Kkg2LrZitixINmF2KrYp9it2KnYqDwvdGV4dD4KPC9zdmc+';
          this.alt = lang === 'ar' ? 'ุตูุฑุฉ ุบูุฑ ูุชุงุญุฉ' : 'Image not available';
        };

        // ุนุฑุถ ุงูุฎูุงุฑุงุช
        mealOptions.innerHTML = '';
        if (meal.options && meal.options[lang] && Array.isArray(meal.options[lang])) {
          console.log('๐ ุฅุถุงูุฉ ุฎูุงุฑุงุช ุงููุฌุจุฉ:', meal.options[lang]);
          meal.options[lang].forEach((opt, index) => {
            const btn = document.createElement('button');
            btn.textContent = opt;
            btn.className = 'option-btn';
            btn.onclick = function() {
              document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
              btn.classList.add('selected');
              console.log('โ ุชู ุงุฎุชูุงุฑ:', opt);
            };
            mealOptions.appendChild(btn);
          });
        } else {
          console.warn('โ๏ธ ูุง ุชูุฌุฏ ุฎูุงุฑุงุช ูููุฌุจุฉ:', selected);
          // ุฅุถุงูุฉ ุฎูุงุฑ ุงูุชุฑุงุถู
          const defaultBtn = document.createElement('button');
          defaultBtn.textContent = lang === 'ar' ? 'ุงุฎุชูุงุฑ' : 'Choice';
          defaultBtn.className = 'option-btn selected';
          mealOptions.appendChild(defaultBtn);
        }

        console.log('โ ุชู ุชุญุฏูุซ ุชูุงุตูู ุงููุฌุจุฉ ุจูุฌุงุญ');

      } catch (error) {
        console.error('โ ุฎุทุฃ ูู ุชุญุฏูุซ ุชูุงุตูู ุงููุฌุจุฉ:', error);
      }
    }

    // ูุนุงูุฌ ุชุบููุฑ ุงููุฌุจุฉ
    function handleMealChange() {
      console.log('๐ ุชุบููุฑ ููุน ุงููุฌุจุฉ...');

      const mealTypeSelect = document.getElementById('meal-type');
      if (mealTypeSelect) {
        const selectedMeal = mealTypeSelect.value;
        console.log('๐ ุงููุฌุจุฉ ุงููุฎุชุงุฑุฉ:', selectedMeal);
        updateMealDetails(selectedMeal);
      } else {
        console.error('โ ุนูุตุฑ ุงุฎุชูุงุฑ ุงููุฌุจุฉ ุบูุฑ ููุฌูุฏ');
      }
    }

    // ุฏุงูุฉ ูุณุงุนุฏุฉ ููุชุญูู ูู ุญุงูุฉ ุงูุตูุญุฉ
    function checkPageStatus() {
      const status = {
        section: document.querySelector('section:not(.hidden)')?.id || 'unknown',
        mealType: document.getElementById('meal-type')?.value || 'none',
        elementsFound: {
          mealName: !!document.getElementById('meal-name'),
          mealDesc: !!document.getElementById('meal-desc'),
          mealImg: !!document.getElementById('meal-img'),
          mealOptions: !!document.getElementById('meal-options')
        }
      };

      console.log('๐ ุญุงูุฉ ุงูุตูุญุฉ:', status);
      return status;
    }

    // ูุนุงูุฌ ุงูุญุฌุฒ
    async function handleReservation() {
      // ุงูุชุญูู ูู ุชุณุฌูู ุงูุฏุฎูู
      if (!canalAPI.isLoggedIn()) {
        alert('ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู ุฃููุงู');
        return;
      }

      // ุงูุชุญูู ูู ูุฌูุฏ ุนูุงุตุฑ ุงูุตูุญุฉ
      if (!mealType) {
        console.error('Meal type element not found');
        return;
      }

      const selectedMealType = mealType.value;
      const activeMeal = getCurrentActiveMeal();

      // ุงูุณูุงุญ ุจุงูุญุฌุฒ ุฅุฐุง ูุงูุช ุงููุฌุจุฉ ุงููุฎุชุงุฑุฉ ูู ุงููุฌุจุฉ ุงููุดุทุฉ ุญุงููุงู
      if (!activeMeal || selectedMealType !== activeMeal) {
        const texts = translations[currentLanguage];
        const currentMealName = activeMeal ? meals[activeMeal].name[currentLanguage] : '';
        const message = activeMeal ?
          `${texts.booking_disabled}\n${currentLanguage === 'ar' ? 'ุงููุฌุจุฉ ุงููุชุงุญุฉ ุญุงููุงู:' : 'Currently available meal:'} ${currentMealName}` :
          texts.booking_disabled;
        alert(message);
        return;
      }

      try {
        // ุงูุญุตูู ุนูู ูุนุฑู ุงููุฌุจุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
        const mealsResult = await canalAPI.getAvailableMeals();
        const meal = mealsResult.meals.find(m => m.meal_type === selectedMealType);

        if (!meal) {
          alert('ุงููุฌุจุฉ ุบูุฑ ูุชุงุญุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช');
          return;
        }

        const selectedOption = document.querySelector('.option-btn.selected');
        const today = new Date().toISOString().split('T')[0];

        // ุญุฌุฒ ุงููุฌุจุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
        const result = await canalAPI.bookMeal(meal.id, null, today);

        if (result.success) {
          const mealName = meals[selectedMealType].name[currentLanguage];
          let msg = currentLanguage === 'ar' ? 'ุชู ุญุฌุฒ ุงููุฌุจุฉ ุจูุฌุงุญ!' : 'Meal booked successfully!';

          if (selectedOption) {
            msg += `\n${currentLanguage === 'ar' ? 'ููุน ุงููุฌุจุฉ:' : 'Meal type:'} ${mealName} - ${selectedOption.textContent}`;
          } else {
            msg += `\n${currentLanguage === 'ar' ? 'ููุน ุงููุฌุจุฉ:' : 'Meal type:'} ${mealName}`;
          }

          // ุฅุถุงูุฉ ุงูููุช ุงูุญุงูู ููุญุฌุฒ
          const now = new Date();
          const timeStr = now.toLocaleTimeString(currentLanguage === 'ar' ? 'ar-SA' : 'en-US', {
            hour: '2-digit',
            minute: '2-digit',
            hour12: false
          });
          msg += `\n${currentLanguage === 'ar' ? 'ููุช ุงูุญุฌุฒ:' : 'Booking time:'} ${timeStr}`;
          msg += `\n${currentLanguage === 'ar' ? 'ุฑูู ุงูุญุฌุฒ:' : 'Reservation ID:'} ${result.reservation_id}`;

          alert(msg);

          console.log('Reservation saved to database:', {
            reservation_id: result.reservation_id,
            meal: selectedMealType,
            option: selectedOption ? selectedOption.textContent : 'default',
            time: timeStr,
            user: currentUser
          });
        } else {
          alert(result.error || 'ูุดู ูู ุญุฌุฒ ุงููุฌุจุฉ');
        }
      } catch (error) {
        console.error('Reservation error:', error);
        alert('ุญุฏุซ ุฎุทุฃ ูู ุนูููุฉ ุงูุญุฌุฒ');
      }
    }

    // ุชููุฆุฉ ุตูุญุฉ ุงููุฌุจุงุช ุนูุฏ ุชุญููู ุงูุตูุญุฉ
    document.addEventListener('DOMContentLoaded', function() {
      console.log('๐ ุชุญููู ุงูุตูุญุฉ ููุชููุ ุจุฏุก ุงูุชููุฆุฉ...');

      // ุชุฃุฎูุฑ ุงูุชููุฆุฉ ููุชุฃูุฏ ูู ุชุญููู ุฌููุน ุงูุนูุงุตุฑ
      setTimeout(() => {
        console.log('โฐ ุจุฏุก ุชููุฆุฉ ุตูุญุฉ ุงููุฌุจุงุช...');

        // ุงูุชุญูู ูู ูุฌูุฏ ุตูุญุฉ ุงููุฌุจุงุช
        const mealsSection = document.getElementById('meals-section');
        if (mealsSection && !mealsSection.classList.contains('hidden')) {
          console.log('๐ ุตูุญุฉ ุงููุฌุจุงุช ููุชูุญุฉุ ุชููุฆุฉ ููุฑูุฉ...');
          initializeMealsSection();
        } else {
          console.log('๐ ุตูุญุฉ ุงููุฌุจุงุช ูุฎููุฉุ ุชููุฆุฉ ุนูุฏ ุงูุญุงุฌุฉ');
        }

        // ุฅุถุงูุฉ ูุณุชูุน ูุชุบููุฑ ุงููุณู
        const navLinks = document.querySelectorAll('[onclick*="showSection"]');
        navLinks.forEach(link => {
          const originalOnclick = link.getAttribute('onclick');
          if (originalOnclick && originalOnclick.includes('meals-section')) {
            link.addEventListener('click', function() {
              setTimeout(() => {
                console.log('๐ฝ๏ธ ุชู ุงูููุฑ ุนูู ุฑุงุจุท ุงููุฌุจุงุช');
                initializeMealsSection();
              }, 200);
            });
          }
        });

      }, 1000);
    });
    </script>
</body><script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js');
}
</script>
</html>
